
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="저장하고 까먹자">
    <title>JPA CustomRepository 작성 시 유의사항 - 저장하고 까먹자</title>
    <meta name="author" content="Junggu Ji">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Junggu Ji","sameAs":["https://github.com/jungguji","mailto"]},"articleBody":"서론 패키지 구조를 수정 후, 기존에 정상 작동하던 custom repository에서 에러가 발생하여, 그 원인과 해결 방법에 대해 정리한다.\n\n본론 코드의 구조는 아래처럼 되어 있다.\nService123456789101112131415@RequiredArgsConstructor@Servicepublic class ReviewFindService &#123;    private final ReviewRepository reviewRepository;    public Review findById(long id) &#123;        return this.reviewRepository.findById(id)            .orElseThrow(EntityNotFoundException::new);    &#125;    public List&lt;Review&gt; findMyReviews() &#123;        return this.reviewRepository.myReviews();    &#125;&#125;\n\nRepository123public interface ReviewRepository extends JpaRepository&lt;Review, Long&gt;, ReviewCustomRepository &#123;&#125;\n\nCustom Repository1234public interface ReviewCustomRepository &#123;    List&lt;Review&gt; myReviews();&#125;\n\nCustom Repository Implementation12345678@Repositorypublic class ReviewCustomRepositoryImpl implements ReviewCustomRepository &#123;    @Override    public List&lt;Review&gt; myReviews() &#123;        return new ArrayList&lt;&gt;();    &#125;&#125;\n\n그림으로\n\n\n Service에서 Repository를 선언하여 사용하고, Repository는 CustomRepository를 상속받고, CustomRepositroy를 CustomRepositoryImpl가 구현체로 작성된 상태이다.\n이때, ReviewFindService의 findMyReviews()를 호출하면, 아래와 같은 exception이 발생하고, 코드가 정상적으로 작동하지 않았다.\n\n123456789101112131415161718192021222324252627282930313233343536373839Caused by: java.lang.IllegalArgumentException: Failed to create query for method public abstract java.util.List com.jgji.sokdak.domain.review.domain.ReviewCustomRepository.myReviews()! No property &#x27;myReviews&#x27; found for type &#x27;Review&#x27;\tat org.springframework.data.jpa.repository.query.PartTreeJpaQuery.&lt;init&gt;(PartTreeJpaQuery.java:96)\tat org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:119)\tat org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateIfNotFoundQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:259)\tat org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$AbstractQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:93)\tat org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lookupQuery(QueryExecutorMethodInterceptor.java:103)\t... 134 moreCaused by: org.springframework.data.mapping.PropertyReferenceException: No property &#x27;myReviews&#x27; found for type &#x27;Review&#x27;\tat org.springframework.data.mapping.PropertyPath.&lt;init&gt;(PropertyPath.java:91)\tat org.springframework.data.mapping.PropertyPath.create(PropertyPath.java:438)\tat org.springframework.data.mapping.PropertyPath.create(PropertyPath.java:414)\tat org.springframework.data.mapping.PropertyPath.lambda$from$0(PropertyPath.java:367)\tat java.base/java.util.concurrent.ConcurrentMap.computeIfAbsent(ConcurrentMap.java:330)\tat org.springframework.data.mapping.PropertyPath.from(PropertyPath.java:349)\tat org.springframework.data.mapping.PropertyPath.from(PropertyPath.java:332)\tat org.springframework.data.repository.query.parser.Part.&lt;init&gt;(Part.java:81)\tat org.springframework.data.repository.query.parser.PartTree$OrPart.lambda$new$0(PartTree.java:250)\tat java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:177)\tat java.base/java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)\tat java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)\tat java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)\tat java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:913)\tat java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\tat java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:578)\tat org.springframework.data.repository.query.parser.PartTree$OrPart.&lt;init&gt;(PartTree.java:251)\tat org.springframework.data.repository.query.parser.PartTree$Predicate.lambda$new$0(PartTree.java:384)\tat java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195)\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:177)\tat java.base/java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)\tat java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484)\tat java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474)\tat java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:913)\tat java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\tat java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:578)\tat org.springframework.data.repository.query.parser.PartTree$Predicate.&lt;init&gt;(PartTree.java:385)\tat org.springframework.data.repository.query.parser.PartTree.&lt;init&gt;(PartTree.java:93)\tat org.springframework.data.jpa.repository.query.PartTreeJpaQuery.&lt;init&gt;(PartTreeJpaQuery.java:89)\t... 138 more\n\n우선, 구현체인 ReviewCustomRepositoryImpl에 Break point 걸어보니, 아예 ReviewCustomRepositoryImpl의 myReviews()가 호출조차 되지 않는 것을 확인했다.그 후 이것저것 코드도 수정해 보고 하였는데, ReviewCustomRepository를 따로 선언하여 사용하니 정상적으로 호출되었다.\nService에서 CustomRepository를 직접 참조1234567891011121314151617@RequiredArgsConstructor@Servicepublic class ReviewFindService &#123;    private final ReviewRepository reviewRepository;    private final ReviewCustomRepository reviewCustomRepository;    public Review findById(long id) &#123;        return this.reviewRepository.findById(id)            .orElseThrow(EntityNotFoundException::new);    &#125;    public List&lt;Review&gt; findMyReviews() &#123;        return this.reviewCustomRepository.myReviews();    &#125;&#125;\n\n기존에 계속 사용하던 구조이기에, CustomRepository를 선언하여 사용하는 방식으로는 문제 해결이 안 된다고 판단하여, 서론에서 말했던 것처럼 최근에 작업한 패키지 구조 수정 중 무언가 문제가 발생하였다고 판단되어 패키지 구조를 열어보니…\n\n\n\n\n\n\n위 이미지처럼, Custom Repository interface와 구현체인 Custom Repository Impl 클래스가 서로 다른 패키지에 존재하고 있었고, \n\n\n\n\n\n\n위처럼 같은 패키지 아래 존재 하도록 위치를 조정해주니 정상적으로 동작하는 것을 확인할 수 있었다.interface는 기본적으로 접근제어자가 public으로 선언되는데, 패키지 위치가 다른 것이 어째서 문제가 되는지 찾아보니.. Spring 공식 문서에서 아래와 같은 가이드를 찾을 수 있었다.\nThe repository infrastructure tries to autodetect custom implementation fragments by scanning for classes below the package in which it found a repository. These classes need to follow the naming convention of appending a postfix defaulting to Impl.\nSpring Data JPA - Reference DocumentationConfiguration\n\n결론 결론적으로, Custom Repository를 작성할 때는 구현체 클래스에 postfix로 Impl가 붙게 만들어야 하고, interface와 같은 위치, 혹은 하위 패키지에 존재하도록 하여야 한다는 것을 알았다.\n\n참고 사이트\nhttps://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.configuration\nhttps://stackoverflow.com/questions/47377989/spring-jpa-custom-repository-different-packages\n\n","dateCreated":"2022-12-26T17:03:01+09:00","dateModified":"2022-12-26T17:03:01+09:00","datePublished":"2022-12-26T17:03:01+09:00","description":"","headline":"JPA CustomRepository 작성 시 유의사항","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/"},"publisher":{"@type":"Organization","name":"Junggu Ji","sameAs":["https://github.com/jungguji","mailto"]},"url":"https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/","keywords":"Spring JPA, Hibernate"}</script>
    <meta name="description" content="서론 패키지 구조를 수정 후, 기존에 정상 작동하던 custom repository에서 에러가 발생하여, 그 원인과 해결 방법에 대해 정리한다.  본론 코드의 구조는 아래처럼 되어 있다. Service123456789101112131415@RequiredArgsConstructor@Servicepublic class ReviewFindService &amp;#12">
<meta property="og:type" content="blog">
<meta property="og:title" content="JPA CustomRepository 작성 시 유의사항">
<meta property="og:url" content="https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/index.html">
<meta property="og:site_name" content="저장하고 까먹자">
<meta property="og:description" content="서론 패키지 구조를 수정 후, 기존에 정상 작동하던 custom repository에서 에러가 발생하여, 그 원인과 해결 방법에 대해 정리한다.  본론 코드의 구조는 아래처럼 되어 있다. Service123456789101112131415@RequiredArgsConstructor@Servicepublic class ReviewFindService &amp;#12">
<meta property="og:locale" content="ko_KR">
<meta property="og:image" content="https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/1_%EA%B5%AC%EC%A1%B0.png">
<meta property="og:image" content="https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/2_%ED%8C%A8%ED%82%A4%EC%A7%80%EA%B5%AC%EC%A1%B0.PNG">
<meta property="og:image" content="https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/3_%EC%84%B1%EA%B3%B5_%ED%8C%A8%ED%82%A4%EC%A7%80%EA%B5%AC%EC%A1%B0.PNG">
<meta property="article:published_time" content="2022-12-26T08:03:01.000Z">
<meta property="article:modified_time" content="2022-12-26T08:03:01.000Z">
<meta property="article:author" content="Junggu Ji">
<meta property="article:tag" content="Spring JPA">
<meta property="article:tag" content="Hibernate">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/1_%EA%B5%AC%EC%A1%B0.png">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-0v3zgfakrzmjoj7mhqewlnecogoqxgnfgvjlrw6b9na0ll2gjplxm4ld0oox.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-162527815-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-162527815-1');
    </script>


    

    
        
    

    <script data-ad-client="ca-pub-6264654331856753" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/" aria-label>
            저장하고 까먹자
        </a>
    </div>
    
        
            <a class="header-right-picture " href="#about" aria-label="링크 열기: /#about">
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/" rel="noopener" title="Home">
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" rel="noopener" title="카테고리">
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" rel="noopener" title="태그">
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-archives" rel="noopener" title="아카이브">
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" rel="noopener" title="About">
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/jungguji" target="_blank" rel="external nofollow noopener noreferrer" title="GitHub">
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/mailto" rel="noopener" title="Mail">
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/atom.xml" rel="noopener" title="RSS">
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4" class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            JPA CustomRepository 작성 시 유의사항
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2022-12-26T17:03:01+09:00">
	
		    2022/12/26
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h2 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h2><p> 패키지 구조를 수정 후, 기존에 정상 작동하던 custom repository에서 에러가 발생하여, 그 원인과 해결 방법에 대해 정리한다.</p>
<hr>
<h2 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h2><p> 코드의 구조는 아래처럼 되어 있다.</p>
<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReviewFindService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReviewRepository reviewRepository;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Review <span class="title">findById</span><span class="params">(<span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.reviewRepository.findById(id)</span><br><span class="line">            .orElseThrow(EntityNotFoundException::<span class="keyword">new</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Review&gt; <span class="title">findMyReviews</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.reviewRepository.myReviews();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ReviewRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Review</span>, <span class="title">Long</span>&gt;, <span class="title">ReviewCustomRepository</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Custom-Repository"><a href="#Custom-Repository" class="headerlink" title="Custom Repository"></a>Custom Repository</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ReviewCustomRepository</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Review&gt; <span class="title">myReviews</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Custom-Repository-Implementation"><a href="#Custom-Repository-Implementation" class="headerlink" title="Custom Repository Implementation"></a>Custom Repository Implementation</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReviewCustomRepositoryImpl</span> <span class="keyword">implements</span> <span class="title">ReviewCustomRepository</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Review&gt; <span class="title">myReviews</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="그림으로"><a href="#그림으로" class="headerlink" title="그림으로"></a>그림으로</h3><img src="/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/1_%EA%B5%AC%EC%A1%B0.png" class>

<br>
 Service에서 Repository를 선언하여 사용하고, Repository는 CustomRepository를 상속받고, CustomRepositroy를 CustomRepositoryImpl가 구현체로 작성된 상태이다.
이때, ReviewFindService의 findMyReviews()를 호출하면, 아래와 같은 exception이 발생하고, 코드가 정상적으로 작동하지 않았다.

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java.lang.IllegalArgumentException: Failed to create query <span class="keyword">for</span> method <span class="keyword">public</span> <span class="keyword">abstract</span> java.util.List com.jgji.sokdak.domain.review.domain.ReviewCustomRepository.myReviews()! No property <span class="string">&#x27;myReviews&#x27;</span> found <span class="keyword">for</span> type <span class="string">&#x27;Review&#x27;</span></span><br><span class="line">	at org.springframework.data.jpa.repository.query.PartTreeJpaQuery.&lt;init&gt;(PartTreeJpaQuery.java:<span class="number">96</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:<span class="number">119</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateIfNotFoundQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:<span class="number">259</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$AbstractQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:<span class="number">93</span>)</span><br><span class="line">	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lookupQuery(QueryExecutorMethodInterceptor.java:<span class="number">103</span>)</span><br><span class="line">	... <span class="number">134</span> more</span><br><span class="line">Caused by: org.springframework.data.mapping.PropertyReferenceException: No property <span class="string">&#x27;myReviews&#x27;</span> found <span class="keyword">for</span> type <span class="string">&#x27;Review&#x27;</span></span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.&lt;init&gt;(PropertyPath.java:<span class="number">91</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.create(PropertyPath.java:<span class="number">438</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.create(PropertyPath.java:<span class="number">414</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.lambda$from$<span class="number">0</span>(PropertyPath.java:<span class="number">367</span>)</span><br><span class="line">	at java.base/java.util.concurrent.ConcurrentMap.computeIfAbsent(ConcurrentMap.java:<span class="number">330</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.from(PropertyPath.java:<span class="number">349</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.from(PropertyPath.java:<span class="number">332</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.Part.&lt;init&gt;(Part.java:<span class="number">81</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree$OrPart.lambda$<span class="keyword">new</span>$<span class="number">0</span>(PartTree.java:<span class="number">250</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline$<span class="number">3</span>$<span class="number">1.</span>accept(ReferencePipeline.java:<span class="number">195</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline$<span class="number">2</span>$<span class="number">1.</span>accept(ReferencePipeline.java:<span class="number">177</span>)</span><br><span class="line">	at java.base/java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:<span class="number">948</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:<span class="number">484</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:<span class="number">474</span>)</span><br><span class="line">	at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:<span class="number">913</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:<span class="number">234</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:<span class="number">578</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree$OrPart.&lt;init&gt;(PartTree.java:<span class="number">251</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree$Predicate.lambda$<span class="keyword">new</span>$<span class="number">0</span>(PartTree.java:<span class="number">384</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline$<span class="number">3</span>$<span class="number">1.</span>accept(ReferencePipeline.java:<span class="number">195</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline$<span class="number">2</span>$<span class="number">1.</span>accept(ReferencePipeline.java:<span class="number">177</span>)</span><br><span class="line">	at java.base/java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:<span class="number">948</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:<span class="number">484</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:<span class="number">474</span>)</span><br><span class="line">	at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:<span class="number">913</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:<span class="number">234</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:<span class="number">578</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree$Predicate.&lt;init&gt;(PartTree.java:<span class="number">385</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree.&lt;init&gt;(PartTree.java:<span class="number">93</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.query.PartTreeJpaQuery.&lt;init&gt;(PartTreeJpaQuery.java:<span class="number">89</span>)</span><br><span class="line">	... <span class="number">138</span> more</span><br></pre></td></tr></table></figure>

<p>우선, 구현체인 ReviewCustomRepositoryImpl에 Break point 걸어보니, 아예 ReviewCustomRepositoryImpl의 myReviews()가 호출조차 되지 않는 것을 확인했다.<br>그 후 이것저것 코드도 수정해 보고 하였는데, ReviewCustomRepository를 따로 선언하여 사용하니 정상적으로 호출되었다.</p>
<h3 id="Service에서-CustomRepository를-직접-참조"><a href="#Service에서-CustomRepository를-직접-참조" class="headerlink" title="Service에서 CustomRepository를 직접 참조"></a>Service에서 CustomRepository를 직접 참조</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReviewFindService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReviewRepository reviewRepository;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReviewCustomRepository reviewCustomRepository;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Review <span class="title">findById</span><span class="params">(<span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.reviewRepository.findById(id)</span><br><span class="line">            .orElseThrow(EntityNotFoundException::<span class="keyword">new</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Review&gt; <span class="title">findMyReviews</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.reviewCustomRepository.myReviews();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>기존에 계속 사용하던 구조이기에, CustomRepository를 선언하여 사용하는 방식으로는 문제 해결이 안 된다고 판단하여, 서론에서 말했던 것처럼 최근에 작업한 패키지 구조 수정 중 무언가 문제가 발생하였다고 판단되어 패키지 구조를 열어보니…</p>
<br>

<img src="/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/2_%ED%8C%A8%ED%82%A4%EC%A7%80%EA%B5%AC%EC%A1%B0.PNG" class>

<br>

<p>위 이미지처럼, Custom Repository interface와 구현체인 Custom Repository Impl 클래스가 서로 다른 패키지에 존재하고 있었고, </p>
<br>

<img src="/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/3_%EC%84%B1%EA%B3%B5_%ED%8C%A8%ED%82%A4%EC%A7%80%EA%B5%AC%EC%A1%B0.PNG" class>

<br>

<p>위처럼 같은 패키지 아래 존재 하도록 위치를 조정해주니 정상적으로 동작하는 것을 확인할 수 있었다.<br>interface는 기본적으로 접근제어자가 public으로 선언되는데, 패키지 위치가 다른 것이 어째서 문제가 되는지 찾아보니.. Spring 공식 문서에서 아래와 같은 가이드를 찾을 수 있었다.</p>
<blockquote><p>The repository infrastructure tries to autodetect custom implementation fragments by scanning for classes below the package in which it found a repository. These classes need to follow the naming convention of appending a postfix defaulting to Impl.</p>
<footer><strong>Spring Data JPA - Reference Documentation</strong><cite><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.configuration">Configuration</a></cite></footer></blockquote>
<hr>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p> 결론적으로, Custom Repository를 작성할 때는 구현체 클래스에 postfix로 Impl가 붙게 만들어야 하고, interface와 같은 위치, 혹은 하위 패키지에 존재하도록 하여야 한다는 것을 알았다.</p>
<hr>
<h2 id="참고-사이트"><a href="#참고-사이트" class="headerlink" title="참고 사이트"></a>참고 사이트</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.configuration">https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.configuration</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://stackoverflow.com/questions/47377989/spring-jpa-custom-repository-different-packages">https://stackoverflow.com/questions/47377989/spring-jpa-custom-repository-different-packages</a></li>
</ul>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">태그</span><br>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Hibernate/" rel="tag">Hibernate</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Spring-JPA/" rel="tag">Spring JPA</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2023/01/04/1829-Maximum-XOR-for-Each-Query/" data-tooltip="LeetCode 1829. Maximum XOR for Each Query" aria-label="이전: LeetCode 1829. Maximum XOR for Each Query">
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2022/11/30/H2-DB%EC%97%90%EC%84%9C-2D-%EC%A2%8C%ED%91%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/" data-tooltip="H2 DB에서 2D 좌표 저장하기" aria-label="다음: H2 DB에서 2D 좌표 저장하기">
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="이 포스트 공유하기">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" title="Facebook에 공유하기" aria-label="Facebook에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://twitter.com/intent/tweet?text=https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" title="Twitter에 공유하기" aria-label="Twitter에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://plus.google.com/share?url=https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" title="Google+에 공유하기" aria-label="Google+에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <script src="https://utteranc.es/client.js" repo="jungguji/blog-comment" issue-term="og:title" theme="github-light" crossorigin="anonymous" async>
</script>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2024 Junggu Ji. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2023/01/04/1829-Maximum-XOR-for-Each-Query/" data-tooltip="LeetCode 1829. Maximum XOR for Each Query" aria-label="이전: LeetCode 1829. Maximum XOR for Each Query">
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2022/11/30/H2-DB%EC%97%90%EC%84%9C-2D-%EC%A2%8C%ED%91%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/" data-tooltip="H2 DB에서 2D 좌표 저장하기" aria-label="다음: H2 DB에서 2D 좌표 저장하기">
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="이 포스트 공유하기">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" title="Facebook에 공유하기" aria-label="Facebook에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://twitter.com/intent/tweet?text=https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" title="Twitter에 공유하기" aria-label="Twitter에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://plus.google.com/share?url=https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" title="Google+에 공유하기" aria-label="Google+에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" aria-label="Facebook에 공유하기" rel="external nofollow noopener noreferrer">
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Facebook에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="_blank" href="https://twitter.com/intent/tweet?text=https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" aria-label="Twitter에 공유하기" rel="external nofollow noopener noreferrer">
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitter에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="_blank" href="https://plus.google.com/share?url=https://jungguji.github.io/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" aria-label="Google+에 공유하기" rel="external nofollow noopener noreferrer">
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Google+에 공유하기</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Junggu Ji</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-goamtf3h90u4wvmhg5penagquqoptje05tyii1tz44r8vwvh6klg97rf1weo.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
