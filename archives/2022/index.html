
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="저장하고 까먹자">
    <title>아카이브: 2022 - 저장하고 까먹자</title>
    <meta name="author" content="Junggu Ji">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="저장하고 까먹자">
<meta property="og:url" content="https://jungguji.github.io/archives/2022/index.html">
<meta property="og:site_name" content="저장하고 까먹자">
<meta property="og:locale" content="ko_KR">
<meta property="article:author" content="Junggu Ji">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-0v3zgfakrzmjoj7mhqewlnecogoqxgnfgvjlrw6b9na0ll2gjplxm4ld0oox.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-162527815-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-162527815-1');
    </script>


    

    

    <script data-ad-client="ca-pub-6264654331856753" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/" aria-label>
            저장하고 까먹자
        </a>
    </div>
    
        
            <a class="header-right-picture " href="#about" aria-label="링크 열기: /#about">
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/" rel="noopener" title="Home">
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" rel="noopener" title="카테고리">
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" rel="noopener" title="태그">
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-archives" rel="noopener" title="아카이브">
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" rel="noopener" title="About">
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/jungguji" target="_blank" rel="external nofollow noopener noreferrer" title="GitHub">
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/mailto" rel="noopener" title="Mail">
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/atom.xml" rel="noopener" title="RSS">
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1" class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/" aria-label=": JPA CustomRepository 작성 시 유의사항">
                            JPA CustomRepository 작성 시 유의사항
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-12-26T17:03:01+09:00">
	
		    2022/12/26
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h2><p> 패키지 구조를 수정 후, 기존에 정상 작동하던 custom repository에서 에러가 발생하여, 그 원인과 해결 방법에 대해 정리한다.</p>
<hr>
<h2 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h2><p> 코드의 구조는 아래처럼 되어 있다.</p>
<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReviewFindService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReviewRepository reviewRepository;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Review <span class="title">findById</span><span class="params">(<span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.reviewRepository.findById(id)</span><br><span class="line">            .orElseThrow(EntityNotFoundException::<span class="keyword">new</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Review&gt; <span class="title">findMyReviews</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.reviewRepository.myReviews();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ReviewRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Review</span>, <span class="title">Long</span>&gt;, <span class="title">ReviewCustomRepository</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Custom-Repository"><a href="#Custom-Repository" class="headerlink" title="Custom Repository"></a>Custom Repository</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ReviewCustomRepository</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Review&gt; <span class="title">myReviews</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Custom-Repository-Implementation"><a href="#Custom-Repository-Implementation" class="headerlink" title="Custom Repository Implementation"></a>Custom Repository Implementation</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReviewCustomRepositoryImpl</span> <span class="keyword">implements</span> <span class="title">ReviewCustomRepository</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Review&gt; <span class="title">myReviews</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="그림으로"><a href="#그림으로" class="headerlink" title="그림으로"></a>그림으로</h3><img src="/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/1_%EA%B5%AC%EC%A1%B0.png" class>

<br>
 Service에서 Repository를 선언하여 사용하고, Repository는 CustomRepository를 상속받고, CustomRepositroy를 CustomRepositoryImpl가 구현체로 작성된 상태이다.
이때, ReviewFindService의 findMyReviews()를 호출하면, 아래와 같은 exception이 발생하고, 코드가 정상적으로 작동하지 않았다.

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java.lang.IllegalArgumentException: Failed to create query <span class="keyword">for</span> method <span class="keyword">public</span> <span class="keyword">abstract</span> java.util.List com.jgji.sokdak.domain.review.domain.ReviewCustomRepository.myReviews()! No property <span class="string">&#x27;myReviews&#x27;</span> found <span class="keyword">for</span> type <span class="string">&#x27;Review&#x27;</span></span><br><span class="line">	at org.springframework.data.jpa.repository.query.PartTreeJpaQuery.&lt;init&gt;(PartTreeJpaQuery.java:<span class="number">96</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:<span class="number">119</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$CreateIfNotFoundQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:<span class="number">259</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.query.JpaQueryLookupStrategy$AbstractQueryLookupStrategy.resolveQuery(JpaQueryLookupStrategy.java:<span class="number">93</span>)</span><br><span class="line">	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.lookupQuery(QueryExecutorMethodInterceptor.java:<span class="number">103</span>)</span><br><span class="line">	... <span class="number">134</span> more</span><br><span class="line">Caused by: org.springframework.data.mapping.PropertyReferenceException: No property <span class="string">&#x27;myReviews&#x27;</span> found <span class="keyword">for</span> type <span class="string">&#x27;Review&#x27;</span></span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.&lt;init&gt;(PropertyPath.java:<span class="number">91</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.create(PropertyPath.java:<span class="number">438</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.create(PropertyPath.java:<span class="number">414</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.lambda$from$<span class="number">0</span>(PropertyPath.java:<span class="number">367</span>)</span><br><span class="line">	at java.base/java.util.concurrent.ConcurrentMap.computeIfAbsent(ConcurrentMap.java:<span class="number">330</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.from(PropertyPath.java:<span class="number">349</span>)</span><br><span class="line">	at org.springframework.data.mapping.PropertyPath.from(PropertyPath.java:<span class="number">332</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.Part.&lt;init&gt;(Part.java:<span class="number">81</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree$OrPart.lambda$<span class="keyword">new</span>$<span class="number">0</span>(PartTree.java:<span class="number">250</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline$<span class="number">3</span>$<span class="number">1.</span>accept(ReferencePipeline.java:<span class="number">195</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline$<span class="number">2</span>$<span class="number">1.</span>accept(ReferencePipeline.java:<span class="number">177</span>)</span><br><span class="line">	at java.base/java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:<span class="number">948</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:<span class="number">484</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:<span class="number">474</span>)</span><br><span class="line">	at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:<span class="number">913</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:<span class="number">234</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:<span class="number">578</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree$OrPart.&lt;init&gt;(PartTree.java:<span class="number">251</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree$Predicate.lambda$<span class="keyword">new</span>$<span class="number">0</span>(PartTree.java:<span class="number">384</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline$<span class="number">3</span>$<span class="number">1.</span>accept(ReferencePipeline.java:<span class="number">195</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline$<span class="number">2</span>$<span class="number">1.</span>accept(ReferencePipeline.java:<span class="number">177</span>)</span><br><span class="line">	at java.base/java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:<span class="number">948</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:<span class="number">484</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:<span class="number">474</span>)</span><br><span class="line">	at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:<span class="number">913</span>)</span><br><span class="line">	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:<span class="number">234</span>)</span><br><span class="line">	at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:<span class="number">578</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree$Predicate.&lt;init&gt;(PartTree.java:<span class="number">385</span>)</span><br><span class="line">	at org.springframework.data.repository.query.parser.PartTree.&lt;init&gt;(PartTree.java:<span class="number">93</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.query.PartTreeJpaQuery.&lt;init&gt;(PartTreeJpaQuery.java:<span class="number">89</span>)</span><br><span class="line">	... <span class="number">138</span> more</span><br></pre></td></tr></table></figure>

<p>우선, 구현체인 ReviewCustomRepositoryImpl에 Break point 걸어보니, 아예 ReviewCustomRepositoryImpl의 myReviews()가 호출조차 되지 않는 것을 확인했다.<br>그 후 이것저것 코드도 수정해 보고 하였는데, ReviewCustomRepository를 따로 선언하여 사용하니 정상적으로 호출되었다.</p>
<h3 id="Service에서-CustomRepository를-직접-참조"><a href="#Service에서-CustomRepository를-직접-참조" class="headerlink" title="Service에서 CustomRepository를 직접 참조"></a>Service에서 CustomRepository를 직접 참조</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReviewFindService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReviewRepository reviewRepository;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReviewCustomRepository reviewCustomRepository;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Review <span class="title">findById</span><span class="params">(<span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.reviewRepository.findById(id)</span><br><span class="line">            .orElseThrow(EntityNotFoundException::<span class="keyword">new</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Review&gt; <span class="title">findMyReviews</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.reviewCustomRepository.myReviews();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>기존에 계속 사용하던 구조이기에, CustomRepository를 선언하여 사용하는 방식으로는 문제 해결이 안 된다고 판단하여, 서론에서 말했던 것처럼 최근에 작업한 패키지 구조 수정 중 무언가 문제가 발생하였다고 판단되어 패키지 구조를 열어보니…</p>
<br>

<img src="/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/2_%ED%8C%A8%ED%82%A4%EC%A7%80%EA%B5%AC%EC%A1%B0.PNG" class>

<br>

<p>위 이미지처럼, Custom Repository interface와 구현체인 Custom Repository Impl 클래스가 서로 다른 패키지에 존재하고 있었고, </p>
<br>

<img src="/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/3_%EC%84%B1%EA%B3%B5_%ED%8C%A8%ED%82%A4%EC%A7%80%EA%B5%AC%EC%A1%B0.PNG" class>

<br>

<p>위처럼 같은 패키지 아래 존재 하도록 위치를 조정해주니 정상적으로 동작하는 것을 확인할 수 있었다.<br>interface는 기본적으로 접근제어자가 public으로 선언되는데, 패키지 위치가 다른 것이 어째서 문제가 되는지 찾아보니.. Spring 공식 문서에서 아래와 같은 가이드를 찾을 수 있었다.</p>
<blockquote><p>The repository infrastructure tries to autodetect custom implementation fragments by scanning for classes below the package in which it found a repository. These classes need to follow the naming convention of appending a postfix defaulting to Impl.</p>
<footer><strong>Spring Data JPA - Reference Documentation</strong><cite><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.configuration">Configuration</a></cite></footer></blockquote>
<hr>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p> 결론적으로, Custom Repository를 작성할 때는 구현체 클래스에 postfix로 Impl가 붙게 만들어야 하고, interface와 같은 위치, 혹은 하위 패키지에 존재하도록 하여야 한다는 것을 알았다.</p>
<hr>
<h2 id="참고-사이트"><a href="#참고-사이트" class="headerlink" title="참고 사이트"></a>참고 사이트</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.configuration">https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.configuration</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://stackoverflow.com/questions/47377989/spring-jpa-custom-repository-different-packages">https://stackoverflow.com/questions/47377989/spring-jpa-custom-repository-different-packages</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a href="/2022/12/26/JPA-CustomRepository-%EC%9E%91%EC%84%B1-%EC%8B%9C-%EC%9C%A0%EC%9D%98%EC%82%AC%ED%95%AD/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                댓글 공유
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2022/11/30/H2-DB%EC%97%90%EC%84%9C-2D-%EC%A2%8C%ED%91%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/" aria-label=": H2 DB에서 2D 좌표 저장하기">
                            H2 DB에서 2D 좌표 저장하기
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-11-30T20:27:13+09:00">
	
		    2022/11/30
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h2><p> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jungguji/sokdak-sokdak">토이 프로젝트</a>를 진행 중, 장소의 위치의 위도, 경도 좌표를 저장해야 했는데, float type의 ‘latitude’, ‘longitude’라는 2개의 컬럼을 만들어서 각각 따로 저장하려고 했는데, 우연찮은 기회에 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://dev.mysql.com/doc/refman/8.0/en/spatial-type-overview.html">공간 데이터 타입</a>이라는 것이 따로 있다는 것을 발견하여 적용해본 경험을 글로 작성하여 보려고 한다.</p>
<h2 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h2> <blockquote><p>공간(空間, 영어: space)은 어떤 물질 또는 물체가 존재할 수 있거나 어떤 일이 일어날 수 있는 장소이다.</p>
<footer><strong>위키백과</strong><cite><a target="_blank" rel="external nofollow noopener noreferrer" href="https://ko.wikipedia.org/wiki/%EA%B3%B5%EA%B0%84">공간</a></cite></footer></blockquote>

<br>

<p>공간 데이터란, 위 같은 점, 선, 면의 공간을 데이터화 한 것을 의미하는데, 필자는 지도에서 위치를 표시하기 위해 2D 공간 데이터인 점(Point) 데이터를 저장할 필요가 있었다.<br>필자는 Spring boot + JPA(Hibernate) + H2 환경을 사용하고 있어서, 공간 데이터를 다루기 위해 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#spatial">hibernate-spatial</a> 의존성을 추가해주었다.</p>
<br>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-spatial<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hibernate.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<p>그 후, hibernate-spatial 라이브러리에 포함된 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/locationtech/jts">The JTS Topology Suite</a>를 사용해 좌표 데이터를 다루면 되는데, 위에서 말한 것처럼 필자는 2D 데이터를 다루기 위해 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://locationtech.github.io/jts/javadoc/org/locationtech/jts/geom/Point.html">Point</a>를 사용했다.</p>
<br>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Embeddable;</span><br><span class="line"><span class="keyword">import</span> lombok.AccessLevel;</span><br><span class="line"><span class="keyword">import</span> lombok.Builder;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.locationtech.jts.geom.Point;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Embeddable</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@NoArgsConstructor(access = AccessLevel.PROTECTED)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;road&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String road;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;jibun&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String jibun;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;zip&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String zip;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;location&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> Point location;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Builder</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Address</span><span class="params">(String road, String jibun, String zip, Point location)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.road = road;</span><br><span class="line">        <span class="keyword">this</span>.jibun = jibun;</span><br><span class="line">        <span class="keyword">this</span>.zip = zip;</span><br><span class="line">        <span class="keyword">this</span>.location = location;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>만약 필자처럼 Point를 사용할 경우 org.springframework.data.geo.Point를 import하면 정상적으로 동작하지 않으므로, 꼭 import문을 확인하길 바란다.</li>
</ul>
<p>위처럼 당차게 Entity class를 작성하고, 아래 같은 테스트 데이터를 넣고, 호기롭게 테스트를 돌려본 결과…</p>
<h3 id="입력-데이터"><a href="#입력-데이터" class="headerlink" title="입력 데이터"></a>입력 데이터</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">22</span>:<span class="number">48</span>:<span class="number">44.230</span> TRACE <span class="number">21788</span> --- [           main] o.h.type.descriptor.sql.BasicBinder      : binding parameter [<span class="number">1</span>] as [TIMESTAMP] - [<span class="keyword">null</span>]</span><br><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">22</span>:<span class="number">48</span>:<span class="number">44.231</span> TRACE <span class="number">21788</span> --- [           main] o.h.type.descriptor.sql.BasicBinder      : binding parameter [<span class="number">2</span>] as [TIMESTAMP] - [<span class="keyword">null</span>]</span><br><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">22</span>:<span class="number">48</span>:<span class="number">44.231</span> TRACE <span class="number">21788</span> --- [           main] o.h.type.descriptor.sql.BasicBinder      : binding parameter [<span class="number">3</span>] as [VARCHAR] - [지번 서울시]</span><br><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">22</span>:<span class="number">48</span>:<span class="number">44.232</span> TRACE <span class="number">21788</span> --- [           main] o.h.type.descriptor.sql.BasicBinder      : binding parameter [<span class="number">4</span>] as [VARBINARY] - [POINT (<span class="number">19</span> <span class="number">2</span>)]</span><br><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">22</span>:<span class="number">48</span>:<span class="number">44.233</span> TRACE <span class="number">21788</span> --- [           main] o.h.type.descriptor.sql.BasicBinder      : binding parameter [<span class="number">5</span>] as [VARCHAR] - [도로명 서울시]</span><br><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">22</span>:<span class="number">48</span>:<span class="number">44.234</span> TRACE <span class="number">21788</span> --- [           main] o.h.type.descriptor.sql.BasicBinder      : binding parameter [<span class="number">6</span>] as [VARCHAR] - [<span class="number">01006</span>]</span><br><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">22</span>:<span class="number">48</span>:<span class="number">44.235</span> TRACE <span class="number">21788</span> --- [           main] o.h.type.descriptor.sql.BasicBinder      : binding parameter [<span class="number">7</span>] as [BIGINT] - [<span class="keyword">null</span>]</span><br><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">22</span>:<span class="number">48</span>:<span class="number">44.235</span> TRACE <span class="number">21788</span> --- [           main] o.h.type.descriptor.sql.BasicBinder      : binding parameter [<span class="number">8</span>] as [VARCHAR] - [우리집]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>위 로그처럼 sql에 입력된 파라미터들이 보고 싶은 경우 아래처럼 설정을 추가해주면 된다.</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">org:</span></span><br><span class="line">      <span class="attr">hibernate:</span></span><br><span class="line">        <span class="attr">type:</span></span><br><span class="line">          <span class="attr">descriptor:</span></span><br><span class="line">            <span class="attr">sql:</span> <span class="string">trace</span></span><br></pre></td></tr></table></figure>


<h3 id="발생한-에러-로그"><a href="#발생한-에러-로그" class="headerlink" title="발생한 에러 로그"></a>발생한 에러 로그</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Caused by: org.h2.jdbc.JdbcSQLDataException: Value too <span class="keyword">long</span> <span class="keyword">for</span> column <span class="string">&quot;LOCATION BINARY VARYING(255)&quot;</span>: <span class="string">&quot;X&#x27;aced00057372001f6f72672e6c6f636174696f6e746563682e6a74732e67656f6d2e506f696e74... (1151)&quot;</span>; SQL statement:</span><br><span class="line"><span class="function">insert into <span class="title">place</span> <span class="params">(id, create_date, update_date, jibun, location, road, zip, category_id, name)</span> <span class="title">values</span> <span class="params">(<span class="keyword">default</span>, ?, ?, ?, ?, ?, ?, ?, ?)</span> [22001-214]</span></span><br><span class="line"><span class="function">	at org.h2.message.DbException.<span class="title">getJdbcSQLException</span><span class="params">(DbException.java:<span class="number">506</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.message.DbException.<span class="title">getJdbcSQLException</span><span class="params">(DbException.java:<span class="number">477</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.message.DbException.<span class="title">get</span><span class="params">(DbException.java:<span class="number">223</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.message.DbException.<span class="title">getValueTooLongException</span><span class="params">(DbException.java:<span class="number">322</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.value.Value.<span class="title">getValueTooLongException</span><span class="params">(Value.java:<span class="number">2573</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.value.Value.<span class="title">convertToVarbinary</span><span class="params">(Value.java:<span class="number">1371</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.value.Value.<span class="title">convertTo</span><span class="params">(Value.java:<span class="number">1125</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.value.Value.<span class="title">convertForAssignTo</span><span class="params">(Value.java:<span class="number">1092</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.table.Column.<span class="title">validateConvertUpdateSequence</span><span class="params">(Column.java:<span class="number">369</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.table.Table.<span class="title">convertInsertRow</span><span class="params">(Table.java:<span class="number">926</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.command.dml.Insert.<span class="title">insertRows</span><span class="params">(Insert.java:<span class="number">167</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.command.dml.Insert.<span class="title">update</span><span class="params">(Insert.java:<span class="number">135</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.command.CommandContainer.<span class="title">executeUpdateWithGeneratedKeys</span><span class="params">(CommandContainer.java:<span class="number">242</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.command.CommandContainer.<span class="title">update</span><span class="params">(CommandContainer.java:<span class="number">163</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.command.Command.<span class="title">executeUpdate</span><span class="params">(Command.java:<span class="number">252</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.jdbc.JdbcPreparedStatement.<span class="title">executeUpdateInternal</span><span class="params">(JdbcPreparedStatement.java:<span class="number">209</span>)</span></span></span><br><span class="line"><span class="function">	at org.h2.jdbc.JdbcPreparedStatement.<span class="title">executeUpdate</span><span class="params">(JdbcPreparedStatement.java:<span class="number">169</span>)</span></span></span><br><span class="line"><span class="function">	at com.zaxxer.hikari.pool.ProxyPreparedStatement.<span class="title">executeUpdate</span><span class="params">(ProxyPreparedStatement.java:<span class="number">61</span>)</span></span></span><br><span class="line"><span class="function">	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.<span class="title">executeUpdate</span><span class="params">(HikariProxyPreparedStatement.java)</span></span></span><br><span class="line"><span class="function">	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.<span class="title">executeUpdate</span><span class="params">(ResultSetReturnImpl.java:<span class="number">197</span>)</span></span></span><br><span class="line"><span class="function">	... 136 more</span></span><br></pre></td></tr></table></figure>

<br>

<h3 id="테이블-생성-SQL"><a href="#테이블-생성-SQL" class="headerlink" title="테이블 생성 SQL"></a>테이블 생성 SQL</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> place (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">bigint</span> <span class="keyword">generated</span> <span class="keyword">by</span> <span class="keyword">default</span> <span class="keyword">as</span> <span class="keyword">identity</span>,</span><br><span class="line">    create_date <span class="built_in">timestamp</span>,</span><br><span class="line">    update_date <span class="built_in">timestamp</span>,</span><br><span class="line">    jibun <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    location varbinary(<span class="number">255</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    road <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    zip <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    category_id <span class="built_in">bigint</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    primary <span class="keyword">key</span> (<span class="keyword">id</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>이처럼 예상하지 못한 결과가 발생하였는데… 로그를 보니, table create 시 좌표를 저장하는 컬럼의 타입이 기대했던 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.h2database.com/html/datatypes.html#geometry_type">GEOMETRY</a>이 아닌, varbinary 타입으로 생성되어서 발생한 에러인가 싶어서 컬럼 타입을 “GEOMETRY”로 지정하고 생성해봤지만, 결과는 마찬가지였다.</p>
<h3 id="수정한-코드-및-실행된-SQL"><a href="#수정한-코드-및-실행된-SQL" class="headerlink" title="수정한 코드 및 실행된 SQL"></a>수정한 코드 및 실행된 SQL</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// columnDefinition 속성으로 컬럼 타입 지정</span></span><br><span class="line"><span class="meta">@Column(name = &quot;location&quot;, nullable = false, columnDefinition = &quot;GEOMETRY&quot;)</span> </span><br><span class="line"><span class="keyword">private</span> Point location;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> place (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">bigint</span> <span class="keyword">generated</span> <span class="keyword">by</span> <span class="keyword">default</span> <span class="keyword">as</span> <span class="keyword">identity</span>,</span><br><span class="line">    create_date <span class="built_in">timestamp</span>,</span><br><span class="line">    update_date <span class="built_in">timestamp</span>,</span><br><span class="line">    jibun <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    location GEOMETRY <span class="keyword">not</span> <span class="literal">null</span>, <span class="comment">-- 정상적으로 컬럼의 데이터 타입이 GEOMETRY로 변경</span></span><br><span class="line">    road <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    zip <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    category_id <span class="built_in">bigint</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    primary <span class="keyword">key</span> (<span class="keyword">id</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>다시 원인을 검색해본 결과… hibernate-spatial에서는 H2가 아닌 H2의 확장 데이터베이스인 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jdeolive/geodb">GeoDB</a>를 지원한다고 되어있는 것을 확인할 수 있었다.</p>
<blockquote><p>The GeoDBDialect supports the GeoDB a spatial extension of the H2 in-memory database.</p>
<footer><strong>Hibernate Docs</strong><cite><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#spatial">GeoDB (H2)</a></cite></footer></blockquote>

<p>그 후 GeoDB를 적용하기 위해 properties 혹은 yaml에 아래처럼 dialect 설정에 org.hibernate.spatial.dialect.h2geodb.GeoDBDialect를 추가해 주면,</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:h2:mem:test</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">sa</span></span><br><span class="line">    <span class="attr">password:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">org.h2.Driver</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">jpa:</span></span><br><span class="line">    <span class="attr">database-platform:</span> <span class="string">org.hibernate.dialect.H2Dialect</span></span><br><span class="line">    <span class="attr">defer-datasource-initialization:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">hibernate:</span></span><br><span class="line">      <span class="attr">ddl-auto:</span> <span class="string">create-drop</span></span><br><span class="line">    <span class="attr">show-sql:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">properties:</span></span><br><span class="line">      <span class="attr">hibernate:</span></span><br><span class="line">        <span class="attr">dialect:</span> <span class="string">org.hibernate.spatial.dialect.h2geodb.GeoDBDialect</span> <span class="comment"># 추가 혹은 변경</span></span><br></pre></td></tr></table></figure>

<h3 id="dialect-설정-전-dialect"><a href="#dialect-설정-전-dialect" class="headerlink" title="dialect 설정 전 dialect"></a>dialect 설정 전 dialect</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">23</span>:<span class="number">37</span>:<span class="number">47.975</span>  INFO <span class="number">15720</span> --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect</span><br></pre></td></tr></table></figure>

<h3 id="dialect-설정-후-dialect"><a href="#dialect-설정-후-dialect" class="headerlink" title="dialect 설정 후 dialect"></a>dialect 설정 후 dialect</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2022</span>-<span class="number">11</span>-<span class="number">30</span> <span class="number">23</span>:<span class="number">35</span>:<span class="number">42.124</span>  INFO <span class="number">18400</span> --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.spatial.dialect.h2geodb.GeoDBDialect</span><br></pre></td></tr></table></figure>

<br>

<img src="/2022/11/30/H2-DB%EC%97%90%EC%84%9C-2D-%EC%A2%8C%ED%91%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/1_%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%84%B1%EA%B3%B5.PNG" class>

<br>

<p>이처럼 테스트가 성공하는 모습을  확인할 수 있었다.</p>
<hr>
<h2 id="참고-사이트"><a href="#참고-사이트" class="headerlink" title="참고 사이트"></a>참고 사이트</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://stackoverflow.com/questions/44261899/geometry-datatype-in-h2-w-spring-jpa">https://stackoverflow.com/questions/44261899/geometry-datatype-in-h2-w-spring-jpa</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a href="/2022/11/30/H2-DB%EC%97%90%EC%84%9C-2D-%EC%A2%8C%ED%91%9C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                댓글 공유
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2022/10/16/Intelli-J-%EC%BD%94%EB%93%9C-%EC%9E%90%EB%8F%99%EC%83%9D%EC%84%B1-with-Live-Template/" aria-label=": Intelli J 코드 자동생성(with Live Template)">
                            Intelli J 코드 자동생성(with Live Template)
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-10-16T15:53:21+09:00">
	
		    2022/10/16
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h2><p> 필자는 항상 단순하고 반복적인 일은 기계가 하고, 사람은 사색해야 한다고 생각한다. 당연하지만 이러한 생각은, 코딩할 때도 마찬가지다. class를 생성할 때마다 붙여야 하는 Annotation들을 (예를 들면 @Getter 같은) 붙이는 게 그렇게 귀찮을 수가 없었는데… 그러던 중 Intelli J의 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.jetbrains.com/ko/2020/05/18/write-code-faster-using-live-templates-ko/">Live Template</a> 이라는 기능을 발견하여 필자 같은 사람들의 고통을 줄여 주고자 이 글을 작성한다.</p>
<hr>
<h2 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h2><img src="/2022/10/16/Intelli-J-%EC%BD%94%EB%93%9C-%EC%9E%90%EB%8F%99%EC%83%9D%EC%84%B1-with-Live-Template/1_settings.PNG" class title="Perference창">

<br>
우선 위 이미지처럼 preference(settings)을 열어서 'Live Templates'를 검색해서 Live Templates 메뉴를 클릭한다.

<img src="/2022/10/16/Intelli-J-%EC%BD%94%EB%93%9C-%EC%9E%90%EB%8F%99%EC%83%9D%EC%84%B1-with-Live-Template/2_template_group.png" class title="Template group 생성">

<br>

<p>열면 오른쪽에 여러 Template 그룹들이 존재하는데 필자처럼 Java가 없다면 Java 그룹을 생성해주거나, 기존 그룹에 탬플릿만 추가하여도 된다.</p>
<img src="/2022/10/16/Intelli-J-%EC%BD%94%EB%93%9C-%EC%9E%90%EB%8F%99%EC%83%9D%EC%84%B1-with-Live-Template/3_template_%EC%83%9D%EC%84%B1.PNG" class title="Template 생성">

<br>

<p>필자는 Entity 클래스를 생성하거나, request, response dto를 생성할 때마다 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@NoArgsConstructor(access = AccessLevel.PROTECTED)</span></span><br></pre></td></tr></table></figure>

<p>annotation을 붙이는게 너무 귀찮아서 위 코드를 탬플릿으로 지정하고 단축키는 ‘gn’으로 설정해줬다.</p>
<img src="/2022/10/16/Intelli-J-%EC%BD%94%EB%93%9C-%EC%9E%90%EB%8F%99%EC%83%9D%EC%84%B1-with-Live-Template/4_template_%EC%A0%81%EC%9A%A9%EC%9C%84%EC%B9%98.png" class title="Template 생성">

<br>

<p>그리고 해당 annotation들은 class에만 적용하면 되므로 Declaration으로만 지정해주었다.</p>
<img src="/2022/10/16/Intelli-J-%EC%BD%94%EB%93%9C-%EC%9E%90%EB%8F%99%EC%83%9D%EC%84%B1-with-Live-Template/5_%EC%83%9D%EC%84%B1.gif" class title="탬플릿화 한 코드 생성">

<br>

<p>모든 설정을 완료하고 이제 설정한 단축키를 지정한 위치에서 사용해보면 이처럼 간단하게 우리가 탬플릿화한 코드가 자동으로 생성되는 모습을 볼 수 있다.</p>
<p>이 글에선 소개하지 않았지만, template text를 입력하는 곳에서 <code>$METHOD_NAME$</code> 처럼 <code>$$</code> 으로 변수를 선언하여 사용하는 방법들도 있으니, 필요한 사람들은 꼭 활용하여 생산성을 높일 수 있기를 바란다. </p>
<hr>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p> 이렇게 우리는 또 작은 할 일과 짧은 시간을 기계에 넘기고 다른 생산적인 일을 할 시간을 얻을 수 있었다. 티끌 모아 태산이라는 말이 있듯이 이런 작은 일들이 줄여서 큰일을 할 수 있기를 바라며 글을 마친다.</p>
<h2 id="참고-사이트"><a href="#참고-사이트" class="headerlink" title="참고 사이트"></a>참고 사이트</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://velog.io/@max9106/IntelliJ-Live-Template">https://velog.io/@max9106/IntelliJ-Live-Template</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a href="/2022/10/16/Intelli-J-%EC%BD%94%EB%93%9C-%EC%9E%90%EB%8F%99%EC%83%9D%EC%84%B1-with-Live-Template/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                댓글 공유
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2022/09/09/Neither-BindingResult-nor-plain-target-object-for-bean-name-command-available-as-request-attribute/" aria-label=": Neither BindingResult nor plain target object for bean name command available as request attribute">
                            Neither BindingResult nor plain target object for bean name command available as request attribute
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-09-09T16:24:22+09:00">
	
		    2022/09/09
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="발생-경위"><a href="#발생-경위" class="headerlink" title="발생 경위"></a>발생 경위</h2><p>기존 Spring 4.3.3을 사용하던 프로젝트를 5.3.22으로 업그레이드 이후 발생하였다.</p>
<h3 id="에러로그-전체"><a href="#에러로그-전체" class="headerlink" title="에러로그 전체"></a>에러로그 전체</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">java.lang.IllegalStateException: Neither BindingResult nor plain target object <span class="keyword">for</span> bean name <span class="string">&#x27;command&#x27;</span> available as request attribute</span><br><span class="line">	at org.springframework.web.servlet.support.BindStatus.&lt;init&gt;(BindStatus.java:<span class="number">153</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:<span class="number">178</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:<span class="number">199</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getName(AbstractDataBoundFormElementTag.java:<span class="number">164</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.writeDefaultAttributes(AbstractDataBoundFormElementTag.java:<span class="number">123</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractHtmlElementTag.writeDefaultAttributes(AbstractHtmlElementTag.java:<span class="number">460</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.SelectTag.writeTagContent(SelectTag.java:<span class="number">405</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:<span class="number">87</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:<span class="number">83</span>)</span><br><span class="line">	at org.apache.jsp.WEB_002dINF.xxxx.xxxx.xxxx_jsp._jspService(new_jsp.java:<span class="number">263</span>)</span><br><span class="line">	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:<span class="number">70</span>)</span><br><span class="line">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class="number">741</span>)</span><br><span class="line">	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:<span class="number">476</span>)</span><br><span class="line">	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:<span class="number">386</span>)</span><br><span class="line">	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:<span class="number">330</span>)</span><br><span class="line">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class="number">741</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">231</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:<span class="number">728</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:<span class="number">591</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:<span class="number">527</span>)</span><br><span class="line">	at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:<span class="number">868</span>)</span><br><span class="line">	at org.apache.jasper.runtime.PageContextImpl.doInclude(PageContextImpl.java:<span class="number">679</span>)</span><br><span class="line">	at org.apache.jasper.runtime.PageContextImpl.include(PageContextImpl.java:<span class="number">673</span>)</span><br><span class="line">	at org.apache.tiles.request.jsp.JspRequest.doInclude(JspRequest.java:<span class="number">123</span>)</span><br><span class="line">	at org.apache.tiles.request.AbstractViewRequest.dispatch(AbstractViewRequest.java:<span class="number">47</span>)</span><br><span class="line">	at org.apache.tiles.request.render.DispatchRenderer.render(DispatchRenderer.java:<span class="number">45</span>)</span><br><span class="line">	at org.apache.tiles.request.render.ChainedDelegateRenderer.render(ChainedDelegateRenderer.java:<span class="number">68</span>)</span><br><span class="line">	at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:<span class="number">259</span>)</span><br><span class="line">	at org.apache.tiles.template.InsertAttributeModel.renderAttribute(InsertAttributeModel.java:<span class="number">188</span>)</span><br><span class="line">	at org.apache.tiles.template.InsertAttributeModel.execute(InsertAttributeModel.java:<span class="number">132</span>)</span><br><span class="line">	at org.apache.tiles.jsp.taglib.InsertAttributeTag.doTag(InsertAttributeTag.java:<span class="number">299</span>)</span><br><span class="line">	at org.apache.jsp.WEB_002dINF.xxxx.xxxx.xxxx_jsp._jspx_meth_t_005finsertAttribute_005f4(layout_jsp.java:<span class="number">10881</span>)</span><br><span class="line">	at org.apache.jsp.WEB_002dINF.xxxx.xxxx.xxxx_jsp._jspService(layout_jsp.java:<span class="number">1242</span>)</span><br><span class="line">	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:<span class="number">70</span>)</span><br><span class="line">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class="number">741</span>)</span><br><span class="line">	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:<span class="number">476</span>)</span><br><span class="line">	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:<span class="number">386</span>)</span><br><span class="line">	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:<span class="number">330</span>)</span><br><span class="line">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class="number">741</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">231</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:<span class="number">52</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">193</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:<span class="number">728</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:<span class="number">470</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:<span class="number">395</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:<span class="number">316</span>)</span><br><span class="line">	at org.apache.tiles.request.servlet.ServletRequest.forward(ServletRequest.java:<span class="number">265</span>)</span><br><span class="line">	at org.apache.tiles.request.servlet.ServletRequest.doForward(ServletRequest.java:<span class="number">228</span>)</span><br><span class="line">	at org.apache.tiles.request.AbstractClientRequest.dispatch(AbstractClientRequest.java:<span class="number">57</span>)</span><br><span class="line">	at org.apache.tiles.request.render.DispatchRenderer.render(DispatchRenderer.java:<span class="number">45</span>)</span><br><span class="line">	at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:<span class="number">259</span>)</span><br><span class="line">	at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:<span class="number">397</span>)</span><br><span class="line">	at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:<span class="number">238</span>)</span><br><span class="line">	at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:<span class="number">221</span>)</span><br><span class="line">	at org.apache.tiles.renderer.DefinitionRenderer.render(DefinitionRenderer.java:<span class="number">59</span>)</span><br><span class="line">	at org.springframework.web.servlet.view.tiles3.TilesView.renderMergedOutputModel(TilesView.java:<span class="number">147</span>)</span><br><span class="line">	at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:<span class="number">316</span>)</span><br><span class="line">	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:<span class="number">1404</span>)</span><br><span class="line">	at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:<span class="number">1148</span>)</span><br><span class="line">	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:<span class="number">1087</span>)</span><br><span class="line">	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:<span class="number">963</span>)</span><br><span class="line">	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:<span class="number">1006</span>)</span><br><span class="line">	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:<span class="number">898</span>)</span><br><span class="line">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class="number">634</span>)</span><br><span class="line">	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:<span class="number">883</span>)</span><br><span class="line">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class="number">741</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">231</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:<span class="number">52</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">193</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.apache.catalina.filters.ExpiresFilter.doFilter(ExpiresFilter.java:<span class="number">1228</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">193</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter.doFilterInternal(OpenEntityManagerInViewFilter.java:<span class="number">186</span>)</span><br><span class="line">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:<span class="number">117</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">193</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:<span class="number">94</span>)</span><br><span class="line">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:<span class="number">117</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">193</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">330</span>)</span><br><span class="line">	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:<span class="number">118</span>)</span><br><span class="line">	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:<span class="number">84</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:<span class="number">113</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:<span class="number">103</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:<span class="number">113</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:<span class="number">146</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:<span class="number">154</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:<span class="number">45</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:<span class="number">199</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:<span class="number">199</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:<span class="number">110</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:<span class="number">57</span>)</span><br><span class="line">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:<span class="number">117</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:<span class="number">87</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:<span class="number">50</span>)</span><br><span class="line">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:<span class="number">117</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:<span class="number">342</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:<span class="number">192</span>)</span><br><span class="line">	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:<span class="number">160</span>)</span><br><span class="line">	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:<span class="number">354</span>)</span><br><span class="line">	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:<span class="number">267</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">193</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:<span class="number">201</span>)</span><br><span class="line">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:<span class="number">117</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:<span class="number">193</span>)</span><br><span class="line">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:<span class="number">166</span>)</span><br><span class="line">	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:<span class="number">199</span>)</span><br><span class="line">	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:<span class="number">96</span>)</span><br><span class="line">	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:<span class="number">543</span>)</span><br><span class="line">	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:<span class="number">139</span>)</span><br><span class="line">	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:<span class="number">81</span>)</span><br><span class="line">	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:<span class="number">678</span>)</span><br><span class="line">	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:<span class="number">87</span>)</span><br><span class="line">	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:<span class="number">343</span>)</span><br><span class="line">	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:<span class="number">609</span>)</span><br><span class="line">	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:<span class="number">65</span>)</span><br><span class="line">	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:<span class="number">810</span>)</span><br><span class="line">	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:<span class="number">1623</span>)</span><br><span class="line">	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:<span class="number">49</span>)</span><br><span class="line">	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:<span class="number">1128</span>)</span><br><span class="line">	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:<span class="number">628</span>)</span><br><span class="line">	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:<span class="number">61</span>)</span><br><span class="line">	at java.base/java.lang.Thread.run(Thread.java:<span class="number">829</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="해결-과정"><a href="#해결-과정" class="headerlink" title="해결 과정"></a>해결 과정</h2><h3 id="에러로그-일부"><a href="#에러로그-일부" class="headerlink" title="에러로그 일부"></a>에러로그 일부</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">	</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">java.lang.IllegalStateException: Neither BindingResult nor plain target object <span class="keyword">for</span> bean name <span class="string">&#x27;command&#x27;</span> available as request attribute</span><br><span class="line">  at org.springframework.web.servlet.support.BindStatus.&lt;init&gt;(BindStatus.java:<span class="number">153</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:<span class="number">178</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:<span class="number">199</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getName(AbstractDataBoundFormElementTag.java:<span class="number">164</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.writeDefaultAttributes(AbstractDataBoundFormElementTag.java:<span class="number">123</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractHtmlElementTag.writeDefaultAttributes(AbstractHtmlElementTag.java:<span class="number">460</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.SelectTag.writeTagContent(SelectTag.java:<span class="number">405</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:<span class="number">87</span>)</span><br><span class="line">	at org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:<span class="number">83</span>)</span><br><span class="line">	at org.apache.jsp.WEB_002dINF.xxxx.xxxx.xxxx_jsp._jspService(new_jsp.java:<span class="number">263</span>)</span><br><span class="line"></span><br><span class="line">  ....</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br>
> Neither BindingResult nor plain target object for bean name 'command' available as request attribute

<br>

<p>짧은 영어 실력과 구글 번역기에 도움으로 해석해보자면 BindingResult이나 ‘command’ 이라는 이름의 bean 을 request의 속성으로 사용할 수 없어서 발생하는 에러인 것 같은데,<br>에러 로그를 확인 한 결과… 위에서 보이는 것 처럼, JSP의 Form Tag에서 에러가 발생하는 것으로 추측되어 4.3.3 version에서 Form Tag를 구현하는 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-framework/docs/4.3.3.RELEASE/javadoc-api/org/springframework/web/servlet/tags/form/FormTag.html#setCommandName-java.lang.String-">FormTag</a>를 확인해보니 commandName 관련된 메서드들이 @Deprecated 로 선언되어서 곧 없어진다고 알려주고 있었는데, 이번에 업그레이드한 5.3.22 version의 FormTag에선 commandName의 getter, setter 메서드들이 없는 것을 확인할 수 있었다.</p>
<img src="/2022/09/09/Neither-BindingResult-nor-plain-target-object-for-bean-name-command-available-as-request-attribute/4.3.3_FormTag.png" class title="4.3.3 version의 CommandName 관련 method">

<br>

<p>그리고 이미지를 보면 알 수 있듯이 기존의 setCommandName 메서드에서도 modelAttribute에 commandName을 저장해서 쓰는 것을 확인할 수 있는데, 5.3.22 에선 해당 메서드가 없어지면서 변수 modelAttribute에 ‘command’가 할당되어 있기에, ‘command’ 라는 bean을 속성으로 사용할 수 없다고 에러가 발생하는 것이었다.</p>
<img src="/2022/09/09/Neither-BindingResult-nor-plain-target-object-for-bean-name-command-available-as-request-attribute/default_modelAttribute.png" class title="modelAttribute 변수의 기본값">

<br>

<img src="/2022/09/09/Neither-BindingResult-nor-plain-target-object-for-bean-name-command-available-as-request-attribute/getModelAttribute.png" class title="Form tag 호출 시 불리는 modelAttribute의 값">

<br>

<p>이렇게 된 것이니 당연하게도 해결 방법은 modelAttribute에 우리가 지정한 속성값이 set 되도록 하면 되는데, 위에서 본 것처럼 기존의 setCommandName에서도 modelAttribute의 값을 사용하고 있었으므로, setModelAttribute로 modelAttribute 값이 저장되도록 하면 문제는 해결될 것이기에, JSP form tag에 commandName 속성을 모두 modelAttribute로 변경한 후 확인해 보면 정상적으로 동작 하는 것을 확인할 수 있을 것이다.</p>
<img src="/2022/09/09/Neither-BindingResult-nor-plain-target-object-for-bean-name-command-available-as-request-attribute/setModelAttribute.png" class title="commandName 속성을 ModelAttribute로 변경 후 Form tag 호출 시 불리는 modelAttribute의 값">

<br>

<img src="/2022/09/09/Neither-BindingResult-nor-plain-target-object-for-bean-name-command-available-as-request-attribute/getModelAttribute_2.png" class title="commandName 속성을 ModelAttribute로 변경 후 Form tag 호출 시 불리는 modelAttribute의 값">
<hr>
<h2 id="참고-사이트"><a href="#참고-사이트" class="headerlink" title="참고 사이트"></a>참고 사이트</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://web-obj.tistory.com/478">https://web-obj.tistory.com/478</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-framework/docs/4.3.3.RELEASE/javadoc-api/org/springframework/web/servlet/tags/form/FormTag.html#setCommandName-java.lang.String-">https://docs.spring.io/spring-framework/docs/4.3.3.RELEASE/javadoc-api/org/springframework/web/servlet/tags/form/FormTag.html#setCommandName-java.lang.String-</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a href="/2022/09/09/Neither-BindingResult-nor-plain-target-object-for-bean-name-command-available-as-request-attribute/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                댓글 공유
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/" aria-label=": Nexus를 이용한 모듈화">
                            Nexus를 이용한 모듈화
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-08-07T20:14:31+09:00">
	
		    2022/08/07
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h2><p> 현재 운영 중인 서비스는 같은 데이터베이스를 공유하는 5개의 프로젝트가 존재하는데, 모두 Spring or Spring boot + JPA를 사용하는 프로젝트들이다.</p>
<p> 이 때문에, 한 프로젝트에서 도메인(Entity) 클래스에 변수를 추가한 경우에 다른 모든 프로젝트에서도 동일하게 추가 해주지 않으면 데이터베이스 조회 시 등 에러가 발생 할 수 밖에 없는데 이런 copy &amp; paste 반복 작업을 개발자가 손수 하다보면 휴먼에러가 발생할 수 밖에 없음은 물론 같은 데이터베이스를 사용하는 Entity 임에도 불구하고 코드가 모두 다른 이상한 상황이 발생 할 수 밖에 없는 구조였다.</p>
<p> 그렇기에 어떻게 할까 고민하던 중 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://techblog.woowahan.com/2637/">멀티모듈 설계 이야기 with Spring, Gradle</a> 이라는 글을 보고 필자의 서비스에도 단일 프로젝트 멀티모듈 구조로 가져갈 까 하다, 각각의 프로젝트마자 깃을 따로 관리하는게 서비스에는 맞다는 생각이 들어 멀티 프로젝트에 Nexus maven 저장소를 이용해서 도메인 클래스들을 분리 시키기로 했다.</p>
<hr>
<h2 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h2><h3 id="현재-시스템의-구조"><a href="#현재-시스템의-구조" class="headerlink" title="현재 시스템의 구조"></a>현재 시스템의 구조</h3><img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%ED%98%84%EC%9E%AC_%EA%B5%AC%EC%A1%B0.png" class title="현재 서비스 구조">

<p>이 처럼 여러 개의 프로젝트가 하나의 데이터베이스를 공유하는 구조로, 같은 데이터베이스 이므로 동일한 내용의 도메인 클래스가 각자 프로젝트에 각각 중복으로 존재하기 때문에 관리가 힘든 상황이다.</p>
<p>때문에 도메인 클래슬들만 모아놓은 새로운 프로젝트를 생성하고, 그 프로젝트를 jar파일로 만들어 라이브러리화 한 후, 내부 Maven 저장소인 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.sonatype.com/products/nexus-repository">Nexus</a>에 업로드해서 다른 프로젝트들에서 dependency에 추가해서 시스템적으로 정합성을 유지하면서 사용 할 수 있게 하려고 한다.</p>
<p>간단하게 정리하면</p>
<ol>
<li>Nexus에 모듈화된 도메인 프로젝트 업로드</li>
<li>다른 프로젝트들에서 라이브러리화 된 도메인 프로젝트를 dependency  추가하여 사용</li>
</ol>
<p>하는 것이 이번 글의 목표이다.</p>
<p><strong>이 포스트에 Nexus를 설치하는 내용까지 담으려고 하니 내용이 너무 길어질 것 같아 nexus는 이미 설치되어 있다고 가정한다.</strong> </p>
<hr>
<h3 id="1-Nexus-설정"><a href="#1-Nexus-설정" class="headerlink" title="1. Nexus 설정"></a>1. Nexus 설정</h3><p>다른 분들의 글들을 보고 nexus를 무사히 설치하고 실행하면 아래와 같은 화면을 볼 수 있을 것이다.</p>
<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/Nexus_%EC%B2%AB%ED%99%94%EB%A9%B4.png" class title="설치 후 첫 화면">

<p>그 후 Sign in 버튼을 클릭하면 초기 아이디와 비밀번호가 저장된 파일의 위치를 알려준다.</p>
<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%A1%9C%EA%B7%B8%EC%9D%B8%ED%99%94%EB%A9%B4.png" class title="로그인 화면">

<br>


<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /설치경로/nexus3/admin.password</span><br></pre></td></tr></table></figure>

<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EC%B4%88%EA%B8%B0_%ED%8C%A8%EC%8A%A4%EC%9B%8C%EB%93%9C.png" class>

<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EC%9D%B5%EB%AA%85%EC%9C%A0%EC%A0%80_%EC%A0%91%EA%B7%BC.png" class>

<ul>
<li>설정 하다보면 아래처럼 익명 사용자도 접근하게 할 것인지 물어보는데 당연히도 수정 할 수 있으므로 적당히 선택해주면 된다.</li>
</ul>
<br>

<hr>
<h3 id="2-Repository-생성"><a href="#2-Repository-생성" class="headerlink" title="2. Repository 생성"></a>2. Repository 생성</h3><p>우선 모듈화한 도메인 프로젝트를 업로드 할 레파지토리부터 생성해야한다.</p>
<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%A0%88%ED%8C%8C%EC%A7%80%ED%86%A0%EB%A6%AC_%EC%83%9D%EC%84%B11.png" class>
<br>
<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%A0%88%ED%8C%8C%EC%A7%80%ED%86%A0%EB%A6%AC_%EC%83%9D%EC%84%B12.png" class>

<br>

<p>레파지토리 type은 group, hosted, proxy가 있지만, 우리는 위 처럼 maven2의 hosted로 생성한다.</p>
<ul>
<li>이때 hosted는 레파지토리 관리자가 직접 호스팅하는 레파지토리 type이고,</li>
<li>다른 것들과의 차이점은 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://help.sonatype.com/repomanager2/configuration/managing-repositories">여기서</a> 확인 해 볼 수 있다.</li>
</ul>
<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%A0%88%ED%8C%8C%EC%A7%80%ED%86%A0%EB%A6%AC_%EC%83%9D%EC%84%B13.png" class>

<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%A0%88%ED%8C%8C%EC%A7%80%ED%86%A0%EB%A6%AC_%EC%83%9D%EC%84%B1_version_policy.png" class>

<br>

<ul>
<li><p>Version policy는</p>
<ul>
<li>Release</li>
<li>Snapshot</li>
<li>Mixed</li>
</ul>
<p>3 가지가 존재하는데, 보통 Snapshot 레파지토리, Release 레파지토리를 따로 만들어 관리해야하지만, 필자는 Mixed로 지정하고 사용하였다.</p>
</li>
</ul>
<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%A0%88%ED%8C%8C%EC%A7%80%ED%86%A0%EB%A6%AC_%EC%83%9D%EC%84%B1_deployment_policy.png" class>

<br>

<ul>
<li><p>Deployment policy는</p>
<ul>
<li>Allow redeploy<ul>
<li>같은 버전으로 재배포 가능하고 덮어씀</li>
</ul>
</li>
<li>Disable redeploy<ul>
<li>같은 버전으로 다시 배포 할 수 없음</li>
</ul>
</li>
<li>Read-only<ul>
<li>아예 배포가 허용되지 않음</li>
</ul>
</li>
<li>Deploy by Replication Only<ul>
<li>레플리카를 사용하는 경우 레플리카로만 배포되고 다른 배포는 차단됨</li>
</ul>
</li>
</ul>
</li>
<li><p>자세한 내용은 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://help.sonatype.com/repomanager3/nexus-repository-administration/repository-management#RepositoryManagement-Hosted">여기서</a> 확인 할 수 있다.</p>
</li>
</ul>
<br>

<hr>
<h3 id="3-Repository-access-유저-생성"><a href="#3-Repository-access-유저-생성" class="headerlink" title="3. Repository access 유저 생성"></a>3. Repository access 유저 생성</h3><h3 id="Role-생성"><a href="#Role-생성" class="headerlink" title="Role 생성"></a>Role 생성</h3><img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/Role%EC%83%9D%EC%84%B11.png" class>

<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/Role%EC%83%9D%EC%84%B12.png" class>

<br>

<p>필터란에 생성한 레파지토리명으로 검색해서 <strong>nx-repository-view-…</strong> 로 시작하는 권한들을 넣어주고, 해당 Role로 레파지토리에 업로드도 할 수 있게 하기 위해 <strong>nx-component-upload</strong> 권한도 넣어준다.</p>
<h3 id="유저-생성"><a href="#유저-생성" class="headerlink" title="유저 생성"></a>유저 생성</h3><img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EC%9C%A0%EC%A0%80%EC%83%9D%EC%84%B11.png" class>

<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EC%9C%A0%EC%A0%80%EC%83%9D%EC%84%B12.png" class>

<br>

<ul>
<li>각 항목들은 각자에 맞게 넣어주고 Role엔 조금 전에 생성한 Role을 넣어주고 생성을 완료하면 우리가 처음에 로그인한 어드민 계정과는 달리 우리가 생성한 repository만 접근 할 수 있는 것을 확인 할 수 있다.</li>
</ul>
<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EC%9C%A0%EC%A0%80%EC%83%9D%EC%84%B13.png" class>

<hr>
<h3 id="4-라이브러리-업로드"><a href="#4-라이브러리-업로드" class="headerlink" title="4. 라이브러리 업로드"></a>4. 라이브러리 업로드</h3><h4 id="settings-xml-설정"><a href="#settings-xml-설정" class="headerlink" title="settings.xml 설정"></a>settings.xml 설정</h4><p>nexus 레파지토리에 접근하기 위해서는 우선, maven 설정 파일인 settings.xml을 수정해야야 한다. 기본적으로는 ~/.m2/settings.xml 으로 설정되어 있으므로 이 곳에 생성해서 사용하거나, 이미 settings.xml을 사용하고 있다면 그 파일을 수정해주면 되는데.. 이도 저도 모르겠으면 아래 이미지 처럼 인텔리제이에서 확인하여 그 위치의 settings.xml을 수정해준다.</p>
<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/settings.png" class>

<br>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/SETTINGS/1.0.0</span></span></span><br><span class="line"><span class="tag"><span class="string"> http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">servers</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">id</span>&gt;</span>junggu-demo-repository<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">username</span>&gt;</span>junggu-demo-user<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">password</span>&gt;</span>qweqwe<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">servers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>id : 레파지토리 서버의 ID (자유롭게 지정)</li>
<li>username : 레파지토리 접근을 위해 생성했던 nexus access 계정 Id</li>
<li>password: 레파지토리 접근을 위해 생성했던 nexus access 계정 password</li>
</ul>
<h4 id="코드-작성"><a href="#코드-작성" class="headerlink" title="코드 작성"></a>코드 작성</h4><p>모듈화할 코드를 작성하면 되는데, 우리는 도메인 영역을 모듈화 할 것이므로 Entity 클래스를 생성해서 테스트 해본다.</p>
<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9A%A9%20%ED%81%B4%EB%9E%98%EC%8A%A4.png" class>

<br>

<h4 id="POM-xml-설정"><a href="#POM-xml-설정" class="headerlink" title="POM.xml 설정"></a>POM.xml 설정</h4><p>코드 작성을 완료했으면 이제 해당 프로젝트를 nexus repository에 업로드 하기 위해 pom.xml에 아래 처럼 설정을 추가해줘야한다.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>junggu-demo-repository<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>junggu nexus repository~ name is free<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8081/repository/junggu-nexus-demo/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>id : settings.xml에서 설정했던 id와 동일해야함.</li>
<li>name : 사람이 식별 할 수 있게 설정.</li>
<li>url : 생성한 repository의 url</li>
</ul>
<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%A0%88%ED%8C%8C%EC%A7%80%ED%86%A0%EB%A6%AC_URL.png" class>

<ul>
<li>&lt;distributionManagement&gt; 와 &lt;repository&gt;대한 자세한 설명은 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://maven.apache.org/pom.html#distribution-management">이 쪽으로</a></li>
</ul>
<h4 id="배포하기"><a href="#배포하기" class="headerlink" title="배포하기"></a>배포하기</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean compile deploy</span><br></pre></td></tr></table></figure>

<ul>
<li>위 명령어로 deploy 하거나 혹은 Intellij에서 deploy를 실행시켜도 된다.</li>
</ul>
<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/deploy_%EC%BD%98%EC%86%94.png" class>

<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/deploy_%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80.png" class>

<ul>
<li>무사히 deploy가 성공했다면 nexus에서 jar 파일이 정상적으로 업로드된 것을 확인 할 수 있고, 이 후엔 이 라이브러리화된 jar파일을 다른 프로젝트들에서 dependency에 추가해서 사용하면 된다.</li>
</ul>
<br>

<hr>
<h3 id="업로드된-라이브러리-사용하기"><a href="#업로드된-라이브러리-사용하기" class="headerlink" title="업로드된 라이브러리 사용하기"></a>업로드된 라이브러리 사용하기</h3><p>업로드된 라이브러리를 사용하기 위해서 사용하고자 하는 프로젝트의 pom.xml에 아래와 같은 설정을 추가해준다.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 모듈화되서 업로드된 도메인 프로젝트 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.junggu.ji<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 라이브러리가 업로드된 Nexus Repository 정보 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>junggu-demo-repository<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>junggu nexus repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8081/repository/junggu-nexus-demo/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>우선 라이브러리가 업로드된 nexus repository의 정보를 입력하고</li>
<li>우리가 업로드한 라이브러리 정보도 dependency에 추가해준다.</li>
<li>이 때, dependency의 속성들이 헷갈린다면, nexus에서 업로드된 jar를 선택 할 경우 아래 이미지처럼 친절하게 알려주므로 복사해서 사용하면 된다.</li>
</ul>
<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EC%97%85%EB%A1%9C%EB%93%9C_%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC_dependency.png" class>

<br>

<h4 id="Entity-호출하기"><a href="#Entity-호출하기" class="headerlink" title="Entity 호출하기"></a>Entity 호출하기</h4><img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%201.png" class>

<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%202.png" class>

<ul>
<li>위 이미지 처럼 dependency 추가 후 maven을 새로고침하면 보이는 것 처럼 추가도 잘 되고 코드에서도 사용 할 수 있는 것 처럼 보이는데 막상 코드에서 사용하려고 하면 아래 이미지에서 보는 것 처럼 정상적으로 호출되지 않는 것을 알 수 있다.</li>
</ul>
<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%203.png" class>

<br>

<ul>
<li>결론부터 이야기하면 우리가 jar로 만든 프로젝트는 Spring boot 프로젝트를 그대로 jar로 패키징 한 것으로, 일반적인 jar 파일이 아닌 Spring boot가 실행 가능한 jar 형태로 패키징 되었기 때문에, jar에 포함된 클래스들을 호출 할 수가 없는 것이다.<ul>
<li>여기서 말하는 실행 가능한 jar는 META-INF에 저장된 MANIFEST.MF에 저장된 정보를 읽어서 실행시키기 때문에 우리가 일반적으로 호출하는 형태로는 사용 할 수 없다.</li>
</ul>
</li>
</ul>
<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%204.png" class>

<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%205.png" class>

<br>

<p>이 실행 가능한 jar를 일반적인 jar로 만들어서 repository에 배포하기 위해서 모듈화하는 프로젝트의 pom.xml에서 아래 설정을 제거 해주고 다른 dependency들에게 각각 version을 지정한 후 maven compiler plugin도 알맞게 추가해주면 되는데</p>
<p>이 때 우리가 삭제한 spring-boot-parent에 포함된 의존성들은 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-parent/2.7.1">여기서</a> 확인 할 수 있으므로, 필요한 것이나 각각 dependency들을 무슨 버전으로 지정해야 할 지 모르겠다면 여기서 확인 후 추가해주면 된다.</p>
<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%206.png" class>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">source</span>&gt;</span>11<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">target</span>&gt;</span>11<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">compilerArgument</span>&gt;</span>-Xlint:all<span class="tag">&lt;/<span class="name">compilerArgument</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>이제 verison을 올린 후 새로고침 해보면 이전과 다르게 BOOT-INF가 없어지고 바로 com. 으로 시작하는 자바 패키지가 노출되는 것을 확인 할 수 있다.</li>
</ul>
<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%207.png" class>

<br>

<p>이제 테스트 코드를 작성해서 돌려보면 테스트가 성공 할 줄 알았으나.. 애석하게도 아래와 같이 Not a managed type 라는 에러를 내뿜으며 우리의 기대를 무참히 박살내는데…</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java.lang.IllegalArgumentException: Not a managed type: <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">junggu</span>.<span class="title">ji</span>.<span class="title">demo</span>.<span class="title">domain</span>.<span class="title">Junggu</span></span></span><br><span class="line">	at org.hibernate.metamodel.internal.MetamodelImpl.managedType(MetamodelImpl.java:582)</span><br><span class="line">	at org.hibernate.metamodel.internal.MetamodelImpl.managedType(MetamodelImpl.java:<span class="number">85</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.support.JpaMetamodelEntityInformation.&lt;init&gt;(JpaMetamodelEntityInformation.java:<span class="number">75</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.support.JpaEntityInformationSupport.getEntityInformation(JpaEntityInformationSupport.java:<span class="number">66</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.support.JpaRepositoryFactory.getEntityInformation(JpaRepositoryFactory.java:<span class="number">233</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.support.JpaRepositoryFactory.getTargetRepository(JpaRepositoryFactory.java:<span class="number">182</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.support.JpaRepositoryFactory.getTargetRepository(JpaRepositoryFactory.java:<span class="number">165</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.support.JpaRepositoryFactory.getTargetRepository(JpaRepositoryFactory.java:<span class="number">76</span>)</span><br><span class="line">	at org.springframework.data.repository.core.support.RepositoryFactorySupport.getRepository(RepositoryFactorySupport.java:<span class="number">325</span>)</span><br><span class="line">	at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.lambda$afterPropertiesSet$<span class="number">5</span>(RepositoryFactoryBeanSupport.java:<span class="number">323</span>)</span><br><span class="line">	at org.springframework.data.util.Lazy.getNullable(Lazy.java:<span class="number">231</span>)</span><br><span class="line">	at org.springframework.data.util.Lazy.get(Lazy.java:<span class="number">115</span>)</span><br><span class="line">	at org.springframework.data.repository.core.support.RepositoryFactoryBeanSupport.afterPropertiesSet(RepositoryFactoryBeanSupport.java:<span class="number">329</span>)</span><br><span class="line">	at org.springframework.data.jpa.repository.support.JpaRepositoryFactoryBean.afterPropertiesSet(JpaRepositoryFactoryBean.java:<span class="number">144</span>)</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:<span class="number">1863</span>)</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:<span class="number">1800</span>)</span><br><span class="line">	... <span class="number">85</span> more</span><br></pre></td></tr></table></figure>


<p>이는 우리가 추가한 라이브러리의 Entithy가 component scan에 인식되지 않아서 Bean context에 등록되지 않았기 때문에 발생하는 에러이다.</p>
<p>왜냐면, spring boot는 기본적으로 <a href="https://jungguji.github.io/2020/05/26/SpringBootApplication-%EC%9D%98-%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D/">@SpringBootApplication</a>안에 있는 @EnableAutoConfiguration으로 스프링이 정의한  외부 의존성들과 @ComponentScan으로 해당 어노테이션 하위 패키지에 있는 클래스들을 탐색해서 Bean으로 등록하는데,</p>
<p>우리가 추가한 라이브러리는 둘 중 어느 위치에도 존재하지 않으므로 당연히 Bean에 등록 될 수없는 것이다.</p>
<h4 id="라이브러리안에-있는-Entity-Bean-context-등록하기"><a href="#라이브러리안에-있는-Entity-Bean-context-등록하기" class="headerlink" title="라이브러리안에 있는 Entity Bean context 등록하기"></a>라이브러리안에 있는 Entity Bean context 등록하기</h4><p>여러 방법이 있겠지만, 필자는 SessionFactory Bean을 따로 만들어서 우리가 만든 Entity가 있는 라이브러리의 패키지까지 스캔 하도록 추가하는 방식을 사용하였다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> LocalSessionFactoryBean <span class="title">entityManagerFactory</span><span class="params">(DataSource dataSource)</span> </span>&#123;</span><br><span class="line">    LocalSessionFactoryBean localSessionFactory = <span class="keyword">new</span> LocalSessionFactoryBean();</span><br><span class="line">    localSessionFactory.setDataSource(dataSource);</span><br><span class="line">    localSessionFactory</span><br><span class="line">        .setPackagesToScan(<span class="string">&quot;com.junggu.ji.usenexus&quot;</span>, <span class="string">&quot;com.junggu.ji.demo&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> localSessionFactory;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h5 id="적당히-작성한-테스트-코드와-성공한-모습"><a href="#적당히-작성한-테스트-코드와-성공한-모습" class="headerlink" title="적당히 작성한 테스트 코드와 성공한 모습"></a>적당히 작성한 테스트 코드와 성공한 모습</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)</span></span><br><span class="line"><span class="meta">@TestPropertySource(&quot;classpath:application-test.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(DatabaseConfig.class)</span></span><br><span class="line"><span class="meta">@DataJpaTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NexusTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JungguRepository jungguRepository;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name = <span class="string">&quot;지중구&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> age = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Gender gender = Gender.MALE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Junggu junggu = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        junggu = Junggu.builder()</span><br><span class="line">            .name(name)</span><br><span class="line">            .age(age)</span><br><span class="line">            .gender(gender)</span><br><span class="line">            .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Junggu when = jungguRepository.save(junggu);</span><br><span class="line"></span><br><span class="line">        assertThat(when.getName()).isEqualTo(junggu.getName());</span><br><span class="line">        assertThat(when.getAge()).isEqualTo(junggu.getAge());</span><br><span class="line">        assertThat(when.getGender()).isEqualTo(junggu.getGender());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<img src="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/%ED%85%8C%EC%8A%A4%ED%8A%B8%20%EC%84%B1%EA%B3%B5.png" class>

<hr>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p>이렇게 우리는 여러 프로젝트에서 공통으로 사용되는 부분을 따로 빼서 모듈화 하는 방법을 알아보았다.</p>
<p> 필자는 단순히 Entity 클래스의 관리를 편하게 하기 위해 이번 모듈화를 진행했지만,  레이어 별로 프레젠테이션 레이어, 서비스 레이어, 도메인 레이어등으로  구분하여 모듈을 구분 할 수도 있을 것 이다. </p>
<p>다만, 이렇게 멀티 프로젝트에 nexus를 이용해서 모듈화를 구현하는 경우, 모듈화한 프로젝트를 수정 했을 때 모듈화된 라이브러리를 사용하는 다른 프로젝트 모든 프로젝트에서도 손수 version을 올려줘야한다는 단점이 있기 때문에(물론 Deployment policy를 Allow redeploy로 설정했다면 상관없다.), 각자의 서비스에서 단일 프로젝트 멀티 모듈 구조가 맞을 지 아니면 필자처럼 멀티 프로젝트인 상태로 모듈화를 구성 할지는 잘 판단해서 구조화를 해야 할 것 이다.</p>
<hr>
<h3 id="P-S"><a href="#P-S" class="headerlink" title="P.S"></a>P.S</h3><p>여담으로.. 필자는 이번 모듈화를 진행하면서 DTO에 의존적인 Entity들에 대해 굉장히 많이 리팩토링을 진행 할 수 있었고, 레이어 별 분리에 대해 다시 한번 생각해보는 계기가 되어서 고생은 좀 많이 했지만, 개인적으로 굉장히 뜻 깊은 시간을 보낼 수 있었다.</p>
<hr>
<h2 id="참고-사이트"><a href="#참고-사이트" class="headerlink" title="참고 사이트"></a>참고 사이트</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://devocean.sk.com/experts/techBoardDetail.do?ID=163423&page=&searchData=DevOps&subIndex=&idList=%5B164007,+163980,+163891,+163887,+163883,+163872,+163843,+163830,+163799,+163729,+163575,+163566,+163499,+163425,+163423,+163419,+163415,+163347,+163346,+163345,+163344,+163311,+163301,+163296,+163295,+163294,+163290,+163263,+163249,+163173,+163170,+163114,+163054,+163008,+162976,+162968,+162962,+162915,+162576,+160298,+159334,+158674,+158428%5D">Nexus3 설치 및 리포지토리 생성 하기</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://devocean.sk.com/experts/techBoardDetail.do?ID=163425&page=&searchData=DevOps&subIndex=&idList=%5B164007,+163980,+163891,+163887,+163883,+163872,+163843,+163830,+163799,+163729,+163575,+163566,+163499,+163425,+163423,+163419,+163415,+163347,+163346,+163345,+163344,+163311,+163301,+163296,+163295,+163294,+163290,+163263,+163249,+163173,+163170,+163114,+163054,+163008,+162976,+162968,+162962,+162915,+162576,+160298,+159334,+158674,+158428%5D">Nexus에 Spring Maven 라이브러리 배포 및 사용하기</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://co-de.tistory.com/68">5분 안에 구축하는 Nexus</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://peaku.co/questions/39613-spring-boot:-mapeo-de-entidades-desde-un-contenedor-externo">https://peaku.co/questions/39613-spring-boot:-mapeo-de-entidades-desde-un-contenedor-externo</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://stackoverflow.com/questions/48416927/spring-boot-required-a-bean-named-entitymanagerfactory-that-could-not-be-foun">https://stackoverflow.com/questions/48416927/spring-boot-required-a-bean-named-entitymanagerfactory-that-could-not-be-foun</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://stackoverflow.com/questions/43705720/how-do-i-import-configuration-classes-in-a-datajpatest-in-a-springboottest">https://stackoverflow.com/questions/43705720/how-do-i-import-configuration-classes-in-a-datajpatest-in-a-springboottest</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a href="/2022/08/07/Nexus%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%AA%A8%EB%93%88%ED%99%94/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                댓글 공유
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2022/04/30/Jackson-JsonCreator%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%97%AD%EC%A7%81%EB%A0%AC%ED%99%94/" aria-label=": Jackson @JsonCreator를 이용한 역직렬화">
                            Jackson @JsonCreator를 이용한 역직렬화
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-04-30T22:00:35+09:00">
	
		    2022/04/30
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h2><p>어쩌다 보니 연속해서 @RequestBody에 관한 글을 작성하게 되었는데… 이전에 말했던 것 처럼 @RequestBody는 Jackson 라이브러리를 사용하기 때문에 기본생성자를 이용해 object(DTO)를 바인딩한다. 그 때문에 다른 생성자에서 validtion등을 처리했다고 해도 당연히 처리되지 않는데 이 때 사용할 수 있는 @JsonCreator에 대해 알아본다.</p>
<hr>
<h2 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h2><h3 id="현재-상황"><a href="#현재-상황" class="headerlink" title="현재 상황"></a>현재 상황</h3><img src="/2022/04/30/Jackson-JsonCreator%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%97%AD%EC%A7%81%EB%A0%AC%ED%99%94/1.JPG" class title="Jackson @JsonCreator를 이용한 역직렬화">

<br>

<img src="/2022/04/30/Jackson-JsonCreator%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%97%AD%EC%A7%81%EB%A0%AC%ED%99%94/2.JPG" class title="Jackson @JsonCreator를 이용한 역직렬화">

<br>

<p>위 이미지들 처럼 Controller와 dto를 만들었다고 했을 때, /test 를 호출해보면 어떻게 될까?</p>
<img src="/2022/04/30/Jackson-JsonCreator%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%97%AD%EC%A7%81%EB%A0%AC%ED%99%94/3.JPG" class title="Jackson @JsonCreator를 이용한 역직렬화">

<br>

<p>@RequestBody를 사용 할 경우 Jackson 라이브러리를 사용해서 기본 생성자를 이용해 매핑시키기 때문에 “여기타고 생성이 될까요?” 라는 로그는 찍히지 않는다.</p>
<p>이 때, DTO에 처리 혹은 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/util/Assert.html">Assert</a> 등을 이용한 validtion을 추가하고 싶다면 어떻게 될까?</p>
<p>생성자에 추가해서 처리하면 좋겠지만, 기본 생성자를 이용해서 생성되므로, controller 혹은 service 단에서 처리해야 한다.(물론 validtion의 경우엔 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.oracle.com/javaee/7/api/javax/validation/Valid.html">@Valid</a>를 통해 어느정도 처리 가능하다.)</p>
<p>이런 경우, 기본 생성자가 아닌 다른 생성자를 이용해 dto를 바인딩 시키고 싶은 경우 사용 할 수 있는 annotation이 바로 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://fasterxml.github.io/jackson-annotations/javadoc/2.6/com/fasterxml/jackson/annotation/JsonCreator.html">@JsonCreator</a>이다.</p>
<p>이제 다시 코드로 돌아와서, 이 @JsonCreator를 생성자에 선언 해놓고 다시 /test를 요청한다면</p>
<img src="/2022/04/30/Jackson-JsonCreator%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%97%AD%EC%A7%81%EB%A0%AC%ED%99%94/4.JPG" class title="Jackson @JsonCreator를 이용한 역직렬화">

<br>

<p>아까와 다르게 @Builder 패턴이 적용된 생성자를 통해 바인딩 되어서 “여기타고 생성이 될까요?” 라는 로그가 정상적으로 찍힌 걸 볼 수 있다.</p>
<hr>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p>이제 우리는 @RequestBody를 사용할 때 기본 생성자만이 아닌 다른 생성자로도 DTO를 바인딩 할 수 있게 되었으므로, @Valid보다 더 정교한 validtion이나, String을 encoding 해야 할 경우에도 service나 controller가 아닌 생성자에서 처리 할 수 있게 되었으므로 테스트도 더 간편하게 할 수 있게 되었다.</p>
<p>번외로 보통 @JsonCreator는 인스턴스화 할 때 사용 할 생성자를 정의 할 때 사용 하는 annotation으로,<br>보통 아래 코드처럼 @JsonProperty와 같이 사용해서 엔티티와 완벽히 일치되지 않는 JSON을 역직렬화할 때 주로 사용하는 것 같다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanWithCreator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonCreator</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BeanWithCreator</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">      <span class="meta">@JsonProperty(&quot;id&quot;)</span> <span class="keyword">int</span> id, </span></span></span><br><span class="line"><span class="function"><span class="params">      <span class="meta">@JsonProperty(&quot;theName&quot;)</span> String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>개인적으로 이렇게 쓸 일이 몇 번이나 있을까 싶긴하지만…</p>
<hr>
<h2 id="전체-코드"><a href="#전체-코드" class="headerlink" title="전체 코드"></a>전체 코드</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jungguji/blog-example-code">https://github.com/jungguji/blog-example-code</a></li>
</ul>
<h2 id="참고-사이트"><a href="#참고-사이트" class="headerlink" title="참고 사이트"></a>참고 사이트</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.baeldung.com/jackson-annotations">https://www.baeldung.com/jackson-annotations</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://fasterxml.github.io/jackson-annotations/javadoc/2.6/com/fasterxml/jackson/annotation/JsonCreator.html">https://fasterxml.github.io/jackson-annotations/javadoc/2.6/com/fasterxml/jackson/annotation/JsonCreator.html</a></li>
<li></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a href="/2022/04/30/Jackson-JsonCreator%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%97%AD%EC%A7%81%EB%A0%AC%ED%99%94/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                댓글 공유
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2022/03/31/RequestBody-%EB%B0%94%EC%9D%B8%EB%94%A9/" aria-label=": RequestBody 바인딩">
                            RequestBody 바인딩
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2022-03-31T22:44:43+09:00">
	
		    2022/03/31
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="서론"><a href="#서론" class="headerlink" title="서론"></a>서론</h2><p>이전에 작성한 글 중에 <a href="https://jungguji.github.io/2021/02/05/Requestbody-Annotation-%EC%82%AC%EC%9A%A9-%EC%8B%9C-%EA%B8%B0%EB%B3%B8-%EC%83%9D%EC%84%B1%EC%9E%90-%ED%95%84%EC%9A%94/">@Requestbody Annotation 사용 시 기본 생성자 필요</a> 라는<br>글을 올린 적이 있는데 글의 마지막에 보면</p>
<blockquote><p>@Requestbody가 jackson 라이브러리를 이용해 매핑하기 때문이다.</p>
<footer><strong>JG.JI</strong><cite>@Requestbody Annotation 사용 시 기본 생성자 필요</cite></footer></blockquote>

<br>

<p>라는 결론으로 글을 마무리 하였는데, <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-1/dashboard">김영한님의 강의</a>에서 해당 내용과 관련해서 자세하게 알려주시는 부분이 있어, 해당 내용을 정리해본다.</p>
<hr>
<h2 id="본론"><a href="#본론" class="headerlink" title="본론"></a>본론</h2><p>우선 Spring에서는 Controller에서 @RequestBody로 넘어오는 파라미터들에 대해서 내부적으로 ObjectMapper를 이용해 JSON 데이터를 우리가 만든 DTO 객체로 변환시켜주고,<br>@ResponseBody인 경우엔, DTO 객체를 JSON 데이터로 변환해서 클라이언트에 넘겨준다.</p>
<p>이렇게해서 해소 될 궁금증이었으면 이 글을 읽으러 오지 않았을테니, 해당 내용에 대하여 코드 레벨에서 자세히 알아보기로 한다.</p>
<p>우선, Spring MVC의 동작 순서를 간략하게 서술하자면(구글에 검색하면 훌륭한 분들이 작성하신 훌륭한 글들이 많으므로)</p>
<ol>
<li>클라이언트에서 요청이 넘어오면 FrontController 역할을 수행하는 DispatcherServlet에서 먼저 확인해서,</li>
<li>핸들러 매핑 리스트 중 해당 요청을 처리 할 수 있는 핸들러를 가져오고,</li>
<li>핸들러 어댑터 리스트 중에서 해당 핸들러를 처리 할 수 있는 핸들러 어댑터를 가져와서,</li>
<li>해당 어댑터에서 우리가 만든 컨트롤러에 호출해서 비즈니스 로직을 처리 한 후,</li>
<li>리턴되는 데이터에 맞게 뷰 리졸버나 메시지컨버터가 동작하고,</li>
<li>알맞게 클라이언트로 반환된다.</li>
</ol>
<p>여기서, @RequestMapping에 대한 request는 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/RequestMappingHandlerAdapter.html">RequestMappingHandlerAdapter</a>에서 처리하는데<br>이 RequestMappingHandlerAdapter는<br>    1. byte[]를 처리하기 위한 ByteArrayHttpMessageConverter<br>    2. String을 처리하기 위한 StringHttpMessageConverter<br>    3. json을 처리하기 위한 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/index.html?org/springframework/http/converter/json/MappingJackson2HttpMessageConverter.html">MappingJackson2HttpMessageConverter</a><br>등을 가지고 있다.</p>
<h3 id="RequestMappingHandlerAdapter에-설정된-MessageConverter들"><a href="#RequestMappingHandlerAdapter에-설정된-MessageConverter들" class="headerlink" title="RequestMappingHandlerAdapter에 설정된 MessageConverter들"></a>RequestMappingHandlerAdapter에 설정된 MessageConverter들</h3><img src="/2022/03/31/RequestBody-%EB%B0%94%EC%9D%B8%EB%94%A9/1_RequestMappingHandlerAdapter_messageConverters.JPG" class title="RequestBody 바인딩 RequestMappingHandlerAdapter에 설정된 MessageConverter들 " alt="RequestMappingHandlerAdapter에 설정된 MessageConverter들">

<br>

<p>그리고 자신이 가지고 있는 ArgumentResolver들 중<br>@RequestBody형식으로 들어오는 파라미터를 처리하기 위해 RequestResponseBodyMethodProcessor 라는 ArgumentResolver를 호출한다.</p>
<h3 id="RequestMappingHandlerAdapter에-설정된-ArgumentResolver들"><a href="#RequestMappingHandlerAdapter에-설정된-ArgumentResolver들" class="headerlink" title="RequestMappingHandlerAdapter에 설정된 ArgumentResolver들"></a>RequestMappingHandlerAdapter에 설정된 ArgumentResolver들</h3><img src="/2022/03/31/RequestBody-%EB%B0%94%EC%9D%B8%EB%94%A9/2_RequestMappingHandlerAdapter_ArgumentResolvers.JPG" class title="RequestBody 바인딩">

<br>

<p>이 RequestResponseBodyMethodProcessor의 readWithMessageConverters 메서드에서 메시지 컨버터 리스트를 loop 돌면서<br>대상 클래스 타입과 미디어 타입 등을 체크해서 알맞은 메시지 컨버터를 호출해서 사용하는데<br>이 때 호출되는 MessageConverter가 MappingJackson2HttpMessageConverter라는 MessageConverter이다.</p>
<h3 id="요청을-처리-할-수-있는-MessageConverter-호출"><a href="#요청을-처리-할-수-있는-MessageConverter-호출" class="headerlink" title="요청을 처리 할 수 있는 MessageConverter 호출"></a>요청을 처리 할 수 있는 MessageConverter 호출</h3><img src="/2022/03/31/RequestBody-%EB%B0%94%EC%9D%B8%EB%94%A9/3_AbstractMessageConverterMethodArgumentResolver_readWithMessageConverters.JPG" class title="RequestBody 바인딩">

<ol>
<li>MessageConverter의 canRead() 메서드로 해당 요청을 처리 할 수 있는 컨버터 인지 확인.</li>
<li>처리 할 수 있으면 read() 메서드로 메시지에서 객체를 읽고 반환한다.</li>
</ol>
<br>

<p>MappingJackson2HttpMessageConverter에서는 최종적으로 readJavaType 메서드가 호출되는데 이 때 objectMapper를 사용해서 json 데이터를 DTO 객체로 변환하는 것을 볼 수 있다.</p>
<h3 id="ObjectMapper를-이용해서-JSON데이터를-변환하는-부분"><a href="#ObjectMapper를-이용해서-JSON데이터를-변환하는-부분" class="headerlink" title="ObjectMapper를 이용해서 JSON데이터를 변환하는 부분"></a>ObjectMapper를 이용해서 JSON데이터를 변환하는 부분</h3><img src="/2022/03/31/RequestBody-%EB%B0%94%EC%9D%B8%EB%94%A9/4_AbstractJackson2HttpMessageConverter_readJavaType.JPG" class title="RequestBody 바인딩">

<hr>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p>보이지 않는 곳에서 이렇게 많은 부분을 스프링에서 처리해주고 있었기 때문에 우리는 Controller에서 편하게 파라미터를 사용 할 수 있고, JSON 데이터도 바로 객체로 받을 수 있는 것이었다.<br>이런 내용을 알아도, 몰라도 결국 같은 방식으로 개발 하겠지만… 언젠가 도움이 되겠거니 생각하고 지금은 궁금증을 해결 했다는 것에 대해 만족한다.<br>이 글을 읽는 다른 분들도 필자와 같은 궁금증이 있었다면 조금이나마 해소가 됐길 바라며..</p>
<hr>
<h2 id="참고-사이트"><a href="#참고-사이트" class="headerlink" title="참고 사이트"></a>참고 사이트</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://velog.io/@conatuseus/RequestBody%EC%97%90-%EA%B8%B0%EB%B3%B8-%EC%83%9D%EC%84%B1%EC%9E%90%EB%8A%94-%EC%99%9C-%ED%95%84%EC%9A%94%ED%95%9C%EA%B0%8">https://velog.io/@conatuseus/RequestBody%EC%97%90-%EA%B8%B0%EB%B3%B8-%EC%83%9D%EC%84%B1%EC%9E%90%EB%8A%94-%EC%99%9C-%ED%95%84%EC%9A%94%ED%95%9C%EA%B0%8</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://csy7792.tistory.com/317">https://csy7792.tistory.com/317</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-1">김영한 - 스프링 MVC 1편 - 백엔드 웹 개발 핵심 기술</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a href="/2022/03/31/RequestBody-%EB%B0%94%EC%9D%B8%EB%94%A9/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                댓글 공유
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2023 Junggu Ji. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Junggu Ji</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-goamtf3h90u4wvmhg5penagquqoptje05tyii1tz44r8vwvh6klg97rf1weo.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
