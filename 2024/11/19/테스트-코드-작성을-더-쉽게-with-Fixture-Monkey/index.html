
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Junggu Ji, 생각의 기록">
    <title>테스트 코드 작성을 더 쉽게 (with. Fixture Monkey) - Junggu Ji, 생각의 기록</title>
    <meta name="author" content="Junggu Ji">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Junggu Ji","sameAs":["https://github.com/jungguji","mailto"]},"articleBody":"1. Fixture Monkey란?Fixture Monkey는 네이버의 내부 프로젝트인 Plasma에서 복잡한 테스트 요구 사항을 해결하기 위해 개발된 도구로, 현재는 오픈 소스로 제공되어 Java와 Kotlin 환경에서 쉽게 적용할 수 있습니다. 이 라이브러리는 기존의 고정된 테스트 데이터 대신  복잡한 객체 타입의 테스트 데이터를 자동으로 생성하여 테스트 코드의 일관성과 효율성을 대폭 향상시킬 수 있는 도구입니다.\n\n2. Fixture Monkey 도입의 필요성1. 클래스에 final 필드가 포함된 경우1234567891011121314151617181920212223@Getter@RequiredArgsConstructorpublic class Member &#123;    private final long id;    private final String name;    private final String email;    private final String phoneNumber;    private final int age;    private final boolean isVerified;    private final LocalDateTime createdAt;    public String getAgeCategory() &#123;        assert this.age &gt;= 0;        if (this.age &lt; 18) &#123;            return &quot;청소년&quot;;        &#125; else if (this.age &lt; 65) &#123;            return &quot;청년&quot;;        &#125; else &#123;            return &quot;시니어&quot;;        &#125;    &#125;&#125;\n\n문제점\nMember 클래스의 필드들이 모두 final로 선언되어 있기 때문에, 단순히 테스트에서 특정 메서드(getAgeCategory)만 검증하려 해도 불필요한 모든 데이터를 포함하여 객체를 생성해야 하는 문제가 있습니다.\n\n1234567891011121314@Testvoid testGetAgeCategory() &#123;    // 청소년    Member minor = new Member(1L, &quot;Alice&quot;, &quot;alice@example.com&quot;, &quot;123456789&quot;, 15, true, LocalDateTime.now());    assertEquals(&quot;청소년&quot;, minor.getAgeCategory());    // 청년    Member adult = new Member(2L, &quot;Bob&quot;, &quot;bob@example.com&quot;, &quot;987654321&quot;, 30, true, LocalDateTime.now());    assertEquals(&quot;청년&quot;, adult.getAgeCategory());    // 시니어    Member senior = new Member(3L, &quot;Charlie&quot;, &quot;charlie@example.com&quot;, &quot;555555555&quot;, 70, true, LocalDateTime.now());    assertEquals(&quot;시니어&quot;, senior.getAgeCategory());&#125;\n\n2. 하나의 클래스에 너무 많은 객체를 포함하는 경우12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455@Getterpublic class Order &#123;    private final long orderId;    private final Customer customer; // 연관된 객체    private final Product product;   // 연관된 객체    private final LocalDateTime orderDate;    public Order(long orderId, Customer customer, Product product, LocalDateTime orderDate) &#123;        this.orderId = orderId;        this.customer = customer;        this.product = product;        this.orderDate = orderDate;    &#125;&#125;@Getterpublic class Customer &#123;    private final long customerId;    private final String name;    private final String email;    private final Address address; // 연관된 객체    public Customer(long customerId, String name, String email, Address address) &#123;        this.customerId = customerId;        this.name = name;        this.email = email;        this.address = address;    &#125;&#125;@Getterpublic class Product &#123;    private final long productId;    private final String productName;    private final double price;    public Product(long productId, String productName, double price) &#123;        this.productId = productId;        this.productName = productName;        this.price = price;    &#125;&#125;@Getterpublic class Address &#123;    private final String street;    private final String city;    private final String zipCode;    public Address(String street, String city, String zipCode) &#123;        this.street = street;        this.city = city;        this.zipCode = zipCode;    &#125;&#125;\n\n문제점\n생성자에 따라서 연관관계가 맺어진 다른 객체들 까지 생성이 필요하고, 또 그 객체에 연결된 객체들 까지 무한히 체이닝될 수 있습니다.\n\n123456789101112131415161718@Test    void testOrderCreation() &#123;        // Address 생성        Address address = new Address(&quot;123 Main St&quot;, &quot;Seoul&quot;, &quot;12345&quot;);        // Customer 생성        Customer customer = new Customer(1L, 1L, &quot;John Doe&quot;, &quot;john@example.com&quot;, address);        // Product 생성        Product product = new Product(1001L, &quot;Laptop&quot;, 1500.00);        // Order 생성        Order order = new Order(5001L, customer, product, LocalDateTime.now());        // 테스트        assertNotNull(order.getCustomer());        assertEquals(&quot;Laptop&quot;, order.getProduct().getProductName());    &#125;\n\n\n위 코드에선 Order 객체를 생성하려면 Customer와 Product 객체가 필요하며, Customer 객체를 생성하려면 Address 객체도 생성해야 합니다.\n테스트에서 단일 객체 검증을 위해 불필요한 객체들을 생성해야 하는 비효율 발생합니다.\n\n3. 객체를 생성할 수 있는 생성자가 존재하지 않는 경우123456789101112131415161718192021222324@Getter@NoArgsConstructor(access = AccessLevel.PROTECTED)@Entity@Table(name = &quot;member&quot;)public class MemberEntity &#123;    @Id    private long id;    private String name;    private String email;    private String phoneNumber;    private int age;    private boolean isVerified;    private LocalDateTime createdAt;    public MemberEntity(String name, String email, String phoneNumber, int age, boolean isVerified) &#123;        this.name = name;        this.email = email;        this.phoneNumber = phoneNumber;        this.age = age;        this.isVerified = isVerified;        this.createdAt = LocalDateTime.now();    &#125;&#125;\n\n문제점\n기본 생성자 외에, 모든 필드를 초기화하는 생성자를 제공하지 않으므로 테스트에서 객체를 생성할 수 없습니다.\n테스트를 위해 public 생성자를 추가하거나 setter를 작성해야 하지만, 이는 프로덕션 코드의 불필요한 수정으로 이어집니다.\n혹은 테스트에서 강제로 객체를 생성하려면 Reflection을 사용해야 할 수 있지만, Reflection은 유지보수성을 떨어뜨리고, 코드 가독성을 저하시킵니다.\n\n4. 요약\n\n\n문제 상황\n설명\nFixture Monkey 도입 효과\n\n\n\n클래스에 final 필드가 포함된 경우\nfinal 필드로 인해 모든 필드를 초기화해야 객체 생성 가능\n필요한 데이터만 선택적으로 생성 가능\n\n\n객체가 너무 많은 연관 객체 포함\n생성자 체이닝으로 인해 테스트에 필요한 객체 생성이 복잡해짐\n의존 객체를 자동 생성하며 필요한 객체만 오버라이드 가능\n\n\n생성자가 존재하지 않는 경우\n생성자가 없어 Reflection 등을 통해 강제로 생성해야 하는 비효율\n테스트용 생성자 추가 없이 객체 생성 과정 단순화 가능\n\n\n\n3. Fixture Monkey의 객체 생성 방식들Introspector란 Fixture Monkey에서 객체가 생성되는 방법을 의미합니다.\nFixtureMonkey가 생성될 때 넣어주는 Introspector에 따라 객체가 생성되는 방법이 달라지게 됩니다.\n1. BeanArbitraryIntrospector\nFixture Monkey가 객체 생성에 사용하는 기본 introspector 입니다.\n리플렉션과 setter 메서드를 사용하여 새 인스턴스를 생성하므로 생성할 클래스에는 인자가 없는 생성자(또는 기본생성자)와 setter가 있어합니다.\n\n2. ConstructorPropertiesArbitraryIntrospector\n생성자에 @ConstructorProperties가 있거나 없으면 클래스가 레코드 타입이어야 합니다.(또는 Lombok을 사용하는 경우 lombok.config 파일에 lombok.anyConstructor.addConstructorProperties=true를 추가할 수 있습니다.)\n\n3. FieldReflectionArbitraryIntrospector\n리플렉션을 사용하여 새 인스턴스를 생성하고 필드를 설정하므로, 생성할 클래스는 인자가 없는 생성자(또는 기본 생성자)와 getter 또는 setter 중 하나를 가져야 합니다.\n만약 final이 아닌 변수가 선언되어 있다면 getter 또는 setter 없이도 사용 가능합니다.\n\n4. BuilderArbitraryIntrospector\n클래스 빌더를 사용하여 클래스를 생성합니다.\n\n5. FailoverArbitraryIntrospector\n테스트 대상이 너무 다양한 객체를 내부적으로 가지고 있을 때 여러 Introspector를 제공할 수 있습니다.\nFailoverArbitraryIntrospector를 사용하면 두 개 이상의 introspector를 사용할 수 있으며, introspector 중 하나가 생성에 실패하더라도 FailoverArbitraryIntrospector는 계속 다음 introspector로 객체 생성을 시도합니다.\n\n6. PriorityConstructorArbitraryIntrospector\n생성자를 사용해서 타입을 생성합니다.\n다만, 생성자 파라미터 이름을 인식하지 못하면 ArbitraryBuilder API를 사용해 생성자 파라미터를 제어할 수 없습니다.\n일반적으로 컴파일 시 바이트 코드에 생성자명과 파라미터명이 코드에서 작상한대로 저장되지 않으므로(arg1, arg2 이런식으로 저장됨) 생성자와 파라미터명을 런타임에 알 수 있도록 매핑 시킬 수 있어야 합니다.\nFixture monkey 공식문서에선 아래 3가지 방법을 제시하고 있습니다.\nrecord 타입\nJVM 옵션 -parameters 활성화\n생성자에 @ConstructorProperties 존재\n\n\n\n\nConstructorPropertiesArbitraryIntrospector와의 차이점\n\n\n\n\n7. 요약\n\n\nIntrospector\n설명\n특징\n\n\n\nBeanArbitraryIntrospector\n기본 introspector로, 인자가 없는 생성자와 setter를 이용해 객체 생성\n일반적인 객체 생성에 적합\n\n\nConstructorPropertiesArbitraryIntrospector\n@ConstructorProperties 또는 레코드 타입을 통해 생성자 사용 가능\n생성자 프로퍼티를 통한 특정 생성 가능\n\n\nFieldReflectionArbitraryIntrospector\n필드 리플렉션으로 객체 생성\nfinal이 아닌 필드에 대해 setter 없이도 가능\n\n\nBuilderArbitraryIntrospector\n빌더 패턴을 사용하여 객체 생성\n빌더 패턴이 있는 객체에 적합\n\n\nFailoverArbitraryIntrospector\n여러 introspector 중 사용 가능한 방식으로 객체 생성 시도\n다양한 객체 생성 조건에 유연하게 대응\n\n\nPriorityConstructorArbitraryIntrospector\n우선 순위가 높은 생성자를 사용하여 객체 생성\n생성자 우선 사용 상황에 적합\n\n\n\n4. 사용 예시1. PriorityConstructorArbitraryIntrospector 사용\nPriorityConstructorArbitraryIntrospector를 이용해 기 존재하는 생성자를 활용하여 객체를 생성합니다.\nRepository에서 데이터를 조회할 경우 @QueryProjection 을 활용하기 위해 DTO(혹은 VO)에서 생성자를 만들어서 사용하고 있는데, 이런 케이스처럼 final 필드가 다수 존재하여, 테스트 객체 생성에 비효율이 발생할 경우 사용하기 좋습니다.\n해당 예시에선 withParameterNamesResolver() 메서드를 이용하여 생성자의 파라미터명을 명시적으로 작성하였습니다. 혹은 위에 설명한 다른 방법을 이용해 런타임에 파라미터명을 알 수 있도록 합니다.\n\n12345678910111213141516171819202122232425262728293031323334private FixtureMonkey fixtureMonkey;@BeforeEachvoid setUp() &#123;    this.fixtureMonkey = FixtureMonkey.builder()            .objectIntrospector(PriorityConstructorArbitraryIntrospector.INSTANCE                    .withParameterNamesResolver(constructor -&gt; List.of(&quot;id&quot;, &quot;name&quot;, &quot;email&quot;, &quot;phoneNumber&quot;, &quot;age&quot;, &quot;verified&quot;, &quot;createdAt&quot;)))            .build();&#125;@ParameterizedTest(name = &quot;&#123;index&#125; =&gt; age=&#123;0&#125;, expectedCategory=&#123;1&#125;&quot;)@MethodSource(&quot;getPersonVoArguments&quot;)void testPersonVoMethods(Integer age, String expectedCategory) &#123;    // given    PersonVo personVo = fixtureMonkey.giveMeBuilder(PersonVo.class)            .set(javaGetter(PersonVo::getId), 1L)            .set(&quot;age&quot;, age)            .sample();    // when    String ageCategory = personVo.getAgeCategory();    // then    assertThat(ageCategory).isEqualTo(expectedCategory);&#125;private static Stream&lt;Arguments&gt; getPersonVoArguments() &#123;    return Stream.of(            Arguments.of(null, &quot;Unknown&quot;),            Arguments.of(15, &quot;청소년&quot;),            Arguments.of(30, &quot;청년&quot;),            Arguments.of(70, &quot;시니어&quot;)    );&#125;\n\n실행 결과\n\n\n테스트에 필요한 age만 넣고 실행 시, 나머지 final 필드들은 알아서 fixture monkey에 의해 채워지거나 null 허용필드인 경우 null이 입력된 것을 볼 수 있습니다.\n\n2. FieldReflectionArbitraryIntrospector 사용\n생성자의 파라미터에 존재하지 않는 값 ( id )을 수정하기 위해 FieldReflectionArbitraryIntrospector 를 활용하여 객체를 생성합니다.\nEntity class인 경우 보통 생성자에 id 필드를 포함한 생성자가 존재하지 않기 때문에(JPA ID를 생성, 관리 하도록 일임하기 때문) Entity 객체 생성 시 사용하기 좋습니다.\n\n\n\nMember Entity12345678910111213141516171819202122232425262728@Getter@NoArgsConstructor(access = AccessLevel.PROTECTED)@Entity@Table(name = &quot;member&quot;)public class MemberEntity &#123;    @Id    private long id;    private String name;    private String email;    private String phoneNumber;    private int age;    private boolean isVerified;    private LocalDateTime createdAt;    public MemberEntity(String name, String email, String phoneNumber, int age, boolean isVerified) &#123;        this.name = name;        this.email = email;        this.phoneNumber = phoneNumber;        this.age = age;        this.isVerified = isVerified;        this.createdAt = LocalDateTime.now();    &#125;    public void verify() &#123;        this.isVerified = true;    &#125;&#125;\n\n\n비즈니스 로직123456789101112131415161718/** * 특정 ID를 가진 회원을 활성화 * @param memberId 회원 ID * @return 활성화된 회원 */@Transactional(rollbackFor = Exception.class)public Member activateMember(long memberId) &#123;    MemberEntity entity = memberRepository.findById(memberId)            .orElseThrow(() -&gt; new IllegalArgumentException(&quot;존재하지 않는 회원 ID: &quot; + memberId));    if (entity.isVerified()) &#123;        throw new IllegalStateException(&quot;이미 활성화된 회원입니다: &quot; + memberId);    &#125;    entity.verify();    entity = memberRepository.save(entity);    return Member.of(entity);&#125;\n\n\n테스트코드 with. fixture monkey12345678910111213141516171819202122232425262728private FixtureMonkey fixtureMonkey;private MemberService memberService;@BeforeEachvoid setUp() &#123;    fixtureMonkey = FixtureMonkey.builder()            .objectIntrospector(FieldReflectionArbitraryIntrospector.INSTANCE)            .build();    memberService = new MemberService(new FakeMemberRepository());&#125;@RepeatedTest(value = 100)void testActivateMemberUsingFixtureMonkey() &#123;    // given    MemberEntity entity = fixtureMonkey.giveMeBuilder(MemberEntity.class)            .set(&quot;isVerified&quot;, false)            .sample();    Member savedMember = memberService.save(entity);    // when    Member activatedMember = memberService.activateMember(savedMember.getId());    // then    assertThat(activatedMember.isVerified()).isTrue();    assertThat(entity.getId()).isEqualTo(activatedMember.getId());&#125;\n\n\n\n\nfixture monkey를 이용해 MemberEntity 객체 생성 시, 테스트해야하는 비즈니스 로직에서 필요한 값만 지정하여 객체를 생성합니다.\n예제에선 isVerified의 상태를 true로 변경하는 것\n\n\n이로 인해 테스트코드의 본래 목적인, 비즈니스 로직 검증에만 집중할 수 있는 간단한 테스트코드를 작성 할 수 있습니다.\n\n\n5. 퀴즈1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859@Component@RequiredArgsConstructorpublic class EventEligibilityChecker &#123;    private final MemberService memberService;    @Value(&quot;$&#123;event.vip.member.ids&#125;&quot;)    private String vipMemberIds;    private static final ZoneOffset KST = ZoneOffset.of(&quot;+09:00&quot;);    /**     * 특정 이벤트 참여 가능 여부를 확인     *     * 조건:     * - VIP 회원이거나     * - 관리자 권한을 가진 회원이거나     * - 이벤트 기간 외에 요청한 회원이라면 false     *     * 그렇지 않다면 true를 반환한다.     *     * @param memberId 확인할 회원 ID     * @param eventStartTime 이벤트 시작 시간     * @param eventEndTime 이벤트 종료 시간     * @return 참여 가능 여부     */    public boolean canParticipate(long memberId, LocalDateTime eventStartTime, LocalDateTime eventEndTime) &#123;        OffsetDateTime currentTime = OffsetDateTime.now();        boolean isEligible = true;        boolean isVipMember = checkVipMember(memberId);        boolean isAdminMember =                checkAdminMember(memberId);        boolean isOutsideEventPeriod = checkOutsideEventPeriod(currentTime, eventStartTime, eventEndTime);        if (isVipMember || isAdminMember || isOutsideEventPeriod) &#123;            isEligible = false;        &#125;        return isEligible;    &#125;    private boolean checkVipMember(long memberId) &#123;        return Arrays.stream(vipMemberIds.split(&quot;,&quot;))                .map(String::trim)                .map(Integer::parseInt)                .anyMatch(id -&gt; id == memberId);    &#125;    private boolean checkAdminMember(long memberId) &#123;        return memberService.hasAdminRole(memberId);    &#125;    private boolean checkOutsideEventPeriod(OffsetDateTime currentTime, LocalDateTime eventStartTime, LocalDateTime eventEndTime) &#123;        OffsetDateTime eventStart = eventStartTime.atOffset(KST);        OffsetDateTime eventEnd = eventEndTime.atOffset(KST);        return currentTime.isBefore(eventStart) || currentTime.isAfter(eventEnd);    &#125;&#125;\n\n\n위 같은 코드는 어떻게 테스트 코드를 작성 할 수 있을까요?\n1. 테스트코드 작성1. Fixture Monkey 사용\n예시 코드\n\n\n해당 케이스에서 적용 할 수 있는 Introspector 가 존재하지 않기 때문에 Fixture monkey로 객체를 생성 할 수 없습니다.\n혹 제가 잘못 알고 있다면, 댓글 등으로 조언 부탁드립니다. (__)\n\n\n\n\n\n\n\n2. @SpringBootTest와 @TestPropertySource 사용\n예시 코드\n\n12345678910111213141516171819202122232425262728293031@SpringBootTest@TestPropertySource(properties = &#123;        &quot;event.vip.member.ids=1,2,3&quot;&#125;)class EventEligibilityCheckerTest &#123;    @Autowired    private EventEligibilityChecker eventEligibilityChecker;    @Autowired    private MemberService memberService;    @ParameterizedTest(name = &quot;&#123;index&#125; =&gt; memberId=&#123;0&#125;, startTime=&#123;1&#125;, endTime=&#123;2&#125;, expectedResult=&#123;3&#125;&quot;)    @MethodSource(&quot;getMemberArguments&quot;)    void testCanParticipate(int memberId, LocalDateTime startTime, LocalDateTime endTime, boolean expectedResult) &#123;        // when        boolean result = eventEligibilityChecker.canParticipate(memberId, startTime, endTime);        // then        assertThat(result).isEqualTo(expectedResult);    &#125;    static Stream&lt;Object[]&gt; getMemberArguments() &#123;        return Stream.of(                new Object[]&#123;1, LocalDateTime.now().minusDays(1), LocalDateTime.now().plusDays(1), false&#125;, // VIP 멤버                new Object[]&#123;99, LocalDateTime.now().minusDays(1), LocalDateTime.now().plusDays(1), false&#125;, // 관리자 멤버                new Object[]&#123;4, LocalDateTime.now().plusDays(1), LocalDateTime.now().plusDays(2), false&#125;, // 이벤트 기간 외                new Object[]&#123;101, LocalDateTime.now().minusDays(1), LocalDateTime.now().plusDays(1), true&#125; // 일반 멤버 (참여 가능)        );    &#125;&#125;\n\n\n\n\n3. Reflection 사용\n예시 코드\n\n12345678910111213141516171819202122232425262728293031public class EventEligibilityCheckerTestWithReflection &#123;    private EventEligibilityChecker eventEligibilityChecker;    @BeforeEach    void setUp() &#123;        eventEligibilityChecker = new EventEligibilityChecker(new MemberService(new FakeMemberRepository()));        // ReflectionTestUtils를 사용해 @Value 필드 설정        ReflectionTestUtils.setField(eventEligibilityChecker, &quot;vipMemberIds&quot;, &quot;1,2,3&quot;);    &#125;    @ParameterizedTest(name = &quot;&#123;index&#125; =&gt; memberId=&#123;0&#125;, startTime=&#123;1&#125;, endTime=&#123;2&#125;, expectedResult=&#123;3&#125;&quot;)    @MethodSource(&quot;getMemberArguments&quot;)    void testCanParticipate(int memberId, LocalDateTime startTime, LocalDateTime endTime, boolean expectedResult) &#123;        // when        boolean result = eventEligibilityChecker.canParticipate(memberId, startTime, endTime);        // then        assertThat(result).isEqualTo(expectedResult);    &#125;    static Stream&lt;Object[]&gt; getMemberArguments() &#123;        return Stream.of(                new Object[]&#123;1, LocalDateTime.now().minusDays(1), LocalDateTime.now().plusDays(1), false&#125;, // VIP 멤버                new Object[]&#123;99, LocalDateTime.now().minusDays(1), LocalDateTime.now().plusDays(1), false&#125;, // 관리자 멤버                new Object[]&#123;4, LocalDateTime.now().plusDays(1), LocalDateTime.now().plusDays(2), false&#125;, // 이벤트 기간 외                new Object[]&#123;101, LocalDateTime.now().minusDays(1), LocalDateTime.now().plusDays(1), true&#125; // 일반 멤버 (참여 가능)        );    &#125;&#125;\n\n\n\n6. 테스트 하기 쉬운 코드\nNo Silver Bullet. - Fred Brooks\n\n단지 테스트코드 작성을 도와주는 도구일 뿐 Fixture Monkey 도 만능은 아닙니다.\n테스트코드를 작성하기 어렵다는 건 테스트 하고자 하는 코드 (System under test)의 설계 혹은 구조가 잘못되어 있다고 테스트코드가 신호를 보내고 있다고 생각해야합니다.\n1. 테스트가 어려운 이유a. 불확실성\n불확실성이란 코드가 외부 데이터나 상태에 의존하여 매번 다른 결과를 만들어내는 것을 의미합니다.\n예를 들어, 현재 시간을 기준으로 동작하는 코드, 랜덤 값을 생성하는 코드, 전역 변수를 사용하는 코드 등은 매 실행 시마다 결과가 달라질 수 있습니다.\n문제코드에선 @Value로 properties에서 주입받는 값들과 OffsetDateTime.now()를 불확실성이라고 할 수 있습니다.\n\nb. 부수효과\n부수효과라 함은 함수 외부의 상태를 변경하는 것을 의미합니다.\n예를 들어 메일을 전송하거나 파일에 데이터를 기록하거나 데이터베이스에 저장하는 코드는 외부 시스템에 변화를 일으킵니다.\n이런 코드들은 단순히 리턴 값을 확인하는 것만으로는 테스트가 불가능하고, 실제로 외부 상태가 바뀌었는지 확인해야 하기 때문에 테스트 비용이 증가하게 됩니다.\n\n2. 테스트 하기 쉬운 코드로 수정하기\n수정된 프로덕션 코드 ( SUT )\n\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556@Component@RequiredArgsConstructorpublic class EventEligibilityCheckerV2 &#123;    private final MemberService memberService;    private final VIPProperties vipProperties;    private final ClockProvider clockProvider;    private static final ZoneOffset KST = ZoneOffset.of(&quot;+09:00&quot;);    /**     * 특정 이벤트 참여 가능 여부를 확인     *     * 조건:     * - VIP 회원이거나     * - 관리자 권한을 가진 회원이거나     * - 이벤트 기간 외에 요청한 회원이라면 false     *     * 그렇지 않다면 true를 반환한다.     *     * @param memberId 확인할 회원 ID     * @param eventStartTime 이벤트 시작 시간     * @param eventEndTime 이벤트 종료 시간     * @return 참여 가능 여부     */    public boolean canParticipate(long memberId, LocalDateTime eventStartTime, LocalDateTime eventEndTime) &#123;        OffsetDateTime currentTime = clockProvider.now();        boolean isEligible = true;        boolean isVipMember = checkVipMember(memberId);        boolean isAdminMember =                checkAdminMember(memberId);        boolean isOutsideEventPeriod = checkOutsideEventPeriod(currentTime, eventStartTime, eventEndTime);        if (isVipMember || isAdminMember || isOutsideEventPeriod) &#123;            isEligible = false;        &#125;        return isEligible;    &#125;    private boolean checkVipMember(long memberId) &#123;        return vipProperties.getIds().contains(memberId);    &#125;    private boolean checkAdminMember(long memberId) &#123;        return memberService.hasAdminRole(memberId);    &#125;    private boolean checkOutsideEventPeriod(OffsetDateTime currentTime, LocalDateTime eventStartTime, LocalDateTime eventEndTime) &#123;        OffsetDateTime eventStart = eventStartTime.atOffset(KST);        OffsetDateTime eventEnd = eventEndTime.atOffset(KST);        return currentTime.isBefore(eventStart) || currentTime.isAfter(eventEnd);    &#125;&#125;\n\n123456789101112131415161718192021222324public interface VIPProperties &#123;    List&lt;Long&gt; getIds();&#125;@ConfigurationProperties(prefix = &quot;event.vip.member&quot;)class VIPPropertiesImpl implements VIPProperties &#123;    private final String ids;    @ConstructorBinding    public VIPPropertiesImpl(String ids) &#123;        this.ids = ids;    &#125;    @Override    public List&lt;Long&gt; getIds() &#123;        return Arrays.stream(this.ids.split(&quot;,&quot;))                .map(String::trim)                .map(Long::parseLong)                .toList();    &#125;&#125;...\n\n\n\n\n수정된 테스트 코드\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849class EventEligibilityCheckerV2Test &#123;    private EventEligibilityCheckerV2 eventEligibilityChecker;    @BeforeEach    void setUp() &#123;        int year = 2024;        int month = 12;        int day =13;        int hour = 11;        int minute = 11;        int second = 11;        eventEligibilityChecker = new EventEligibilityCheckerV2(                new MemberService(new FakeMemberRepository())                , new FakeVIPProperties(Arrays.asList(1L,2L,3L))                , new FakeSystemClockProvider(OffsetDateTime.of(year, month, day, hour, minute, second, 11, ZoneOffset.UTC))        );    &#125;    @ParameterizedTest(name = &quot;&#123;index&#125; =&gt; memberId=&#123;0&#125;, startTime=&#123;1&#125;, endTime=&#123;2&#125;, expectedResult=&#123;3&#125;&quot;)    @MethodSource(&quot;getMemberArguments&quot;)    void testCanParticipate(int memberId, LocalDateTime startTime, LocalDateTime endTime, boolean expectedResult) &#123;        // when        boolean result = eventEligibilityChecker.canParticipate(memberId, startTime, endTime);        // then        assertThat(result).isEqualTo(expectedResult);    &#125;    static Stream&lt;Object[]&gt; getMemberArguments() &#123;        int year = 2024;        int month = 12;        int day =13;        int hour = 11;        int minute = 11;        int second = 11;        LocalDateTime eventStartDate = LocalDateTime.of(year, month, day-1, hour, minute, second);        LocalDateTime eventEndDate = LocalDateTime.of(year, month, day+1, hour, minute, second);        return Stream.of(                new Object[]&#123;1, eventStartDate, eventEndDate, false&#125;, // VIP 멤버                new Object[]&#123;99, eventStartDate, eventEndDate, false&#125;, // 관리자 멤버                new Object[]&#123;4, eventEndDate.plusDays(1), eventEndDate.plusDays(2), false&#125;, // 이벤트 기간 외                new Object[]&#123;101, eventStartDate, eventEndDate, true&#125; // 일반 멤버 (참여 가능)        );    &#125;&#125;\n\n\n\n\n\n3. 코드 개선으로 인해 얻게된 이점\n책임 분리: 설정값을 전용 프로퍼티 클래스 (VIPProperties)로 관리하게 되어 EventEligibilityCheckerV2의 책임이 명확해졌습니다.\n유연성 증가: VIPProperties, ClockProvider와 같은 인터페이스를 사용하여 설정값에 대한 종속성이 외부로 분리하였고, 설정값을 추상화하여, 다양한 설정 구현체를 주입할 수 있습니다. 위 예시에선 테스트코드 내에서 Fake 구현체 작성하고 해당 구현체로 객체를 생성 하도록하여 테스트하였습니다.\n코드 가독성: @Value 어노테이션 없이 구성 클래스를 사용하므로, 전체적인 코드의 가독성이 향상됩니다.\n\n\n7. 결론앞서 설명한 설계와 테스트 코드 개선에 더해 Fixture Monkey와 같은 도구를 활용하면 다음과 같은 이점을 얻을 수 있습니다.\n\n테스트 데이터 자동 생성\n\nFixture Monkey는 복잡한 객체 구조에 대해 필요한 데이터를 자동으로 생성합니다. 이를 통해 테스트를 작성할 때 불필요한 데이터 생성 로직을 줄이고 테스트 로직에 집중할 수 있습니다.\n\n\n객체의 불변성과 유연성 유지\n\n기존 객체를 수정하거나 Setter를 추가하지 않아도 Fixture Monkey를 통해 객체를 유연하게 생성 및 수정할 수 있습니다. 특히, 불변 객체(immutable object)나 생성자가 많은 객체를 쉽게 테스트할 수 있습니다.\n\n\n데이터 커스터마이징\n\n특정 필드에 대한 값을 명시적으로 설정하거나 조건에 맞는 객체를 생성할 수 있습니다. 예를 들어, VIP 멤버 ID 목록처럼 특정 조건을 가진 데이터를 간단하게 생성할 수 있습니다.\n\n\n테스트 유지보수 비용 절감\n\n새로운 필드가 추가되거나 객체 구조가 변경되어도 Fixture Monkey를 사용하면 테스트 코드 수정 범위를 최소화할 수 있습니다.\n\n\n\n\n\n\n잘 작성된 테스트는 단순히 코드의 동작을 검증하는 역할을 넘어, 코드의 설계와 구조적 결함을 발견하게 해줍니다.Fixture Monkey와 같은 도구를 활용하면 코드의 불확실성과 부수효과를 줄이면서도 객체 생성과 테스트를 효율적으로 수행할 수 있습니다.특히, 복잡한 객체나 다양한 조건의 테스트 데이터를 쉽게 생성할 수 있어 테스트 작성 비용을 절감하고 테스트 품질을 향상시킬 수 있습니다.  \n그러나 도구의 활용보다 중요한 것은 테스트 가능한 설계를 만드는 것입니다.테스트 가능한 설계는 테스트 코드로 하여금 코드 설계의 개선 방향을 제시하게 하며, 결과적으로 유지보수성과 확장성을 높이는 기반이 됩니다.\n긴 글 읽어주셔서 감사합니다.\n\n참고자료\nFixture Monkey 공식문서\n테스트 객체는 엣지 케이스까지 찾아주는 Fixture Monkey에게 맡기세요\nTestable Code by Jin-Wook Chung\n무엇을 테스트할 것인가? 어떻게 테스트할 것인가? (권용근)\n실무에서 적용하는 테스트 코드 작성 방법과 노하우 (김남윤)\n왜 나는 테스트를 작성하기 싫을까? (조성아)\n\n\n전체 코드\nhttps://github.com/jungguji/fixture-monkey-sample\n\n","dateCreated":"2024-11-19T23:16:40+09:00","dateModified":"2024-11-19T23:16:40+09:00","datePublished":"2024-11-19T23:16:40+09:00","description":"","headline":"테스트 코드 작성을 더 쉽게 (with. Fixture Monkey)","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/"},"publisher":{"@type":"Organization","name":"Junggu Ji","sameAs":["https://github.com/jungguji","mailto"]},"url":"https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/","keywords":"test"}</script>
    <meta name="description" content="1. Fixture Monkey란?Fixture Monkey는 네이버의 내부 프로젝트인 Plasma에서 복잡한 테스트 요구 사항을 해결하기 위해 개발된 도구로, 현재는 오픈 소스로 제공되어 Java와 Kotlin 환경에서 쉽게 적용할 수 있습니다. 이 라이브러리는 기존의 고정된 테스트 데이터 대신  복잡한 객체 타입의 테스트 데이터를 자동으로 생성하여 테스">
<meta property="og:type" content="blog">
<meta property="og:title" content="테스트 코드 작성을 더 쉽게 (with. Fixture Monkey)">
<meta property="og:url" content="https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/index.html">
<meta property="og:site_name" content="Junggu Ji, 생각의 기록">
<meta property="og:description" content="1. Fixture Monkey란?Fixture Monkey는 네이버의 내부 프로젝트인 Plasma에서 복잡한 테스트 요구 사항을 해결하기 위해 개발된 도구로, 현재는 오픈 소스로 제공되어 Java와 Kotlin 환경에서 쉽게 적용할 수 있습니다. 이 라이브러리는 기존의 고정된 테스트 데이터 대신  복잡한 객체 타입의 테스트 데이터를 자동으로 생성하여 테스">
<meta property="og:locale" content="ko_KR">
<meta property="article:published_time" content="2024-11-19T14:16:40.000Z">
<meta property="article:modified_time" content="2024-11-19T14:16:40.000Z">
<meta property="article:author" content="Junggu Ji">
<meta property="article:tag" content="test">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-vaqxmiojfeym1obe22l4wzlc2exrxuyy1hezfoyofzx2ow3vxa49a2skiig7.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-162527815-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-162527815-1');
    </script>


    

    
        
    

    <script data-ad-client="ca-pub-6264654331856753" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/" aria-label>
            Junggu Ji, 생각의 기록
        </a>
    </div>
    
        
            <a class="header-right-picture " href="#about" aria-label="링크 열기: /#about">
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/" rel="noopener" title="Home">
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" rel="noopener" title="카테고리">
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" rel="noopener" title="태그">
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-archives" rel="noopener" title="아카이브">
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" rel="noopener" title="About">
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/jungguji" target="_blank" rel="external nofollow noopener noreferrer" title="GitHub">
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/mailto" rel="noopener" title="Mail">
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/atom.xml" rel="noopener" title="RSS">
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4" class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            테스트 코드 작성을 더 쉽게 (with. Fixture Monkey)
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2024-11-19T23:16:40+09:00">
	
		    2024/11/19
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h1 id="1-Fixture-Monkey란"><a href="#1-Fixture-Monkey란" class="headerlink" title="1. Fixture Monkey란?"></a>1. <strong>Fixture Monkey란?</strong></h1><p>Fixture Monkey는 네이버의 내부 프로젝트인 <strong>Plasma</strong>에서 복잡한 테스트 요구 사항을 해결하기 위해 개발된 도구로, 현재는 오픈 소스로 제공되어 Java와 Kotlin 환경에서 쉽게 적용할 수 있습니다. 이 라이브러리는 기존의 고정된 테스트 데이터 대신  복잡한 객체 타입의 테스트 데이터를 자동으로 생성하여 테스트 코드의 일관성과 효율성을 대폭 향상시킬 수 있는 도구입니다.</p>
<hr>
<h1 id="2-Fixture-Monkey-도입의-필요성"><a href="#2-Fixture-Monkey-도입의-필요성" class="headerlink" title="2. Fixture Monkey 도입의 필요성"></a>2. Fixture Monkey 도입의 필요성</h1><h2 id="1-클래스에-final-필드가-포함된-경우"><a href="#1-클래스에-final-필드가-포함된-경우" class="headerlink" title="1. 클래스에 final 필드가 포함된 경우"></a>1. 클래스에 final 필드가 포함된 경우</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String email;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String phoneNumber;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">boolean</span> isVerified;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LocalDateTime createdAt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAgeCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">assert</span> <span class="keyword">this</span>.age &gt;= <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.age &lt; <span class="number">18</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;청소년&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.age &lt; <span class="number">65</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;청년&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;시니어&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="문제점"><a href="#문제점" class="headerlink" title="문제점"></a>문제점</h3><ul>
<li>Member 클래스의 필드들이 모두 final로 선언되어 있기 때문에, 단순히 테스트에서 특정 메서드(getAgeCategory)만 검증하려 해도 불필요한 모든 데이터를 포함하여 객체를 생성해야 하는 문제가 있습니다.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testGetAgeCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 청소년</span></span><br><span class="line">    Member minor = <span class="keyword">new</span> Member(<span class="number">1L</span>, <span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;alice@example.com&quot;</span>, <span class="string">&quot;123456789&quot;</span>, <span class="number">15</span>, <span class="keyword">true</span>, LocalDateTime.now());</span><br><span class="line">    assertEquals(<span class="string">&quot;청소년&quot;</span>, minor.getAgeCategory());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 청년</span></span><br><span class="line">    Member adult = <span class="keyword">new</span> Member(<span class="number">2L</span>, <span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;bob@example.com&quot;</span>, <span class="string">&quot;987654321&quot;</span>, <span class="number">30</span>, <span class="keyword">true</span>, LocalDateTime.now());</span><br><span class="line">    assertEquals(<span class="string">&quot;청년&quot;</span>, adult.getAgeCategory());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 시니어</span></span><br><span class="line">    Member senior = <span class="keyword">new</span> Member(<span class="number">3L</span>, <span class="string">&quot;Charlie&quot;</span>, <span class="string">&quot;charlie@example.com&quot;</span>, <span class="string">&quot;555555555&quot;</span>, <span class="number">70</span>, <span class="keyword">true</span>, LocalDateTime.now());</span><br><span class="line">    assertEquals(<span class="string">&quot;시니어&quot;</span>, senior.getAgeCategory());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-하나의-클래스에-너무-많은-객체를-포함하는-경우"><a href="#2-하나의-클래스에-너무-많은-객체를-포함하는-경우" class="headerlink" title="2. 하나의 클래스에 너무 많은 객체를 포함하는 경우"></a>2. 하나의 클래스에 너무 많은 객체를 포함하는 경우</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> orderId;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Customer customer; <span class="comment">// 연관된 객체</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Product product;   <span class="comment">// 연관된 객체</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LocalDateTime orderDate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Order</span><span class="params">(<span class="keyword">long</span> orderId, Customer customer, Product product, LocalDateTime orderDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderId = orderId;</span><br><span class="line">        <span class="keyword">this</span>.customer = customer;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">        <span class="keyword">this</span>.orderDate = orderDate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> customerId;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String email;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Address address; <span class="comment">// 연관된 객체</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Customer</span><span class="params">(<span class="keyword">long</span> customerId, String name, String email, Address address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.customerId = customerId;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> productId;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String productName;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span> price;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Product</span><span class="params">(<span class="keyword">long</span> productId, String productName, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.productId = productId;</span><br><span class="line">        <span class="keyword">this</span>.productName = productName;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String street;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String city;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String zipCode;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Address</span><span class="params">(String street, String city, String zipCode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.street = street;</span><br><span class="line">        <span class="keyword">this</span>.city = city;</span><br><span class="line">        <span class="keyword">this</span>.zipCode = zipCode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="문제점-1"><a href="#문제점-1" class="headerlink" title="문제점"></a>문제점</h3><ul>
<li>생성자에 따라서 연관관계가 맺어진 다른 객체들 까지 생성이 필요하고, 또 그 객체에 연결된 객체들 까지 무한히 체이닝될 수 있습니다.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testOrderCreation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Address 생성</span></span><br><span class="line">        Address address = <span class="keyword">new</span> Address(<span class="string">&quot;123 Main St&quot;</span>, <span class="string">&quot;Seoul&quot;</span>, <span class="string">&quot;12345&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Customer 생성</span></span><br><span class="line">        Customer customer = <span class="keyword">new</span> Customer(<span class="number">1L</span>, <span class="number">1L</span>, <span class="string">&quot;John Doe&quot;</span>, <span class="string">&quot;john@example.com&quot;</span>, address);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Product 생성</span></span><br><span class="line">        Product product = <span class="keyword">new</span> Product(<span class="number">1001L</span>, <span class="string">&quot;Laptop&quot;</span>, <span class="number">1500.00</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Order 생성</span></span><br><span class="line">        Order order = <span class="keyword">new</span> Order(<span class="number">5001L</span>, customer, product, LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 테스트</span></span><br><span class="line">        assertNotNull(order.getCustomer());</span><br><span class="line">        assertEquals(<span class="string">&quot;Laptop&quot;</span>, order.getProduct().getProductName());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>위 코드에선 Order 객체를 생성하려면 Customer와 Product 객체가 필요하며, Customer 객체를 생성하려면 Address 객체도 생성해야 합니다.</li>
<li>테스트에서 단일 객체 검증을 위해 불필요한 객체들을 생성해야 하는 비효율 발생합니다.</li>
</ul>
<h2 id="3-객체를-생성할-수-있는-생성자가-존재하지-않는-경우"><a href="#3-객체를-생성할-수-있는-생성자가-존재하지-않는-경우" class="headerlink" title="3. 객체를 생성할 수 있는 생성자가 존재하지 않는 경우"></a>3. 객체를 생성할 수 있는 생성자가 존재하지 않는 경우</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@NoArgsConstructor(access = AccessLevel.PROTECTED)</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;member&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> String phoneNumber;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isVerified;</span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createdAt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MemberEntity</span><span class="params">(String name, String email, String phoneNumber, <span class="keyword">int</span> age, <span class="keyword">boolean</span> isVerified)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">        <span class="keyword">this</span>.phoneNumber = phoneNumber;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.isVerified = isVerified;</span><br><span class="line">        <span class="keyword">this</span>.createdAt = LocalDateTime.now();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="문제점-2"><a href="#문제점-2" class="headerlink" title="문제점"></a>문제점</h3><ul>
<li>기본 생성자 외에, 모든 필드를 초기화하는 생성자를 제공하지 않으므로 테스트에서 객체를 생성할 수 없습니다.</li>
<li>테스트를 위해 public 생성자를 추가하거나 setter를 작성해야 하지만, 이는 프로덕션 코드의 불필요한 수정으로 이어집니다.</li>
<li>혹은 테스트에서 강제로 객체를 생성하려면 Reflection을 사용해야 할 수 있지만, Reflection은 유지보수성을 떨어뜨리고, 코드 가독성을 저하시킵니다.</li>
</ul>
<h2 id="4-요약"><a href="#4-요약" class="headerlink" title="4. 요약"></a>4. 요약</h2><table>
<thead>
<tr>
<th>문제 상황</th>
<th>설명</th>
<th>Fixture Monkey 도입 효과</th>
</tr>
</thead>
<tbody><tr>
<td>클래스에 final 필드가 포함된 경우</td>
<td>final 필드로 인해 모든 필드를 초기화해야 객체 생성 가능</td>
<td>필요한 데이터만 선택적으로 생성 가능</td>
</tr>
<tr>
<td>객체가 너무 많은 연관 객체 포함</td>
<td>생성자 체이닝으로 인해 테스트에 필요한 객체 생성이 복잡해짐</td>
<td>의존 객체를 자동 생성하며 필요한 객체만 오버라이드 가능</td>
</tr>
<tr>
<td>생성자가 존재하지 않는 경우</td>
<td>생성자가 없어 Reflection 등을 통해 강제로 생성해야 하는 비효율</td>
<td>테스트용 생성자 추가 없이 객체 생성 과정 단순화 가능</td>
</tr>
</tbody></table>
<hr>
<h1 id="3-Fixture-Monkey의-객체-생성-방식들"><a href="#3-Fixture-Monkey의-객체-생성-방식들" class="headerlink" title="3. Fixture Monkey의 객체 생성 방식들"></a>3. Fixture Monkey의 객체 생성 방식들</h1><p><code>Introspector</code>란 Fixture Monkey에서 <strong>객체가 생성되는 방법</strong>을 의미합니다.</p>
<p><code>FixtureMonkey</code>가 생성될 때 넣어주는 <code>Introspector</code>에 따라 객체가 생성되는 방법이 달라지게 됩니다.</p>
<h2 id="1-BeanArbitraryIntrospector"><a href="#1-BeanArbitraryIntrospector" class="headerlink" title="1. BeanArbitraryIntrospector"></a>1. BeanArbitraryIntrospector</h2><ul>
<li>Fixture Monkey가 객체 생성에 사용하는 기본 introspector 입니다.</li>
<li>리플렉션과 setter 메서드를 사용하여 새 인스턴스를 생성하므로 생성할 클래스에는 인자가 없는 생성자(또는 기본생성자)와 setter가 있어합니다.</li>
</ul>
<h2 id="2-ConstructorPropertiesArbitraryIntrospector"><a href="#2-ConstructorPropertiesArbitraryIntrospector" class="headerlink" title="2. ConstructorPropertiesArbitraryIntrospector"></a>2. ConstructorPropertiesArbitraryIntrospector</h2><ul>
<li>생성자에 <code>@ConstructorProperties</code>가 있거나 없으면 클래스가 레코드 타입이어야 합니다.<br>(또는 Lombok을 사용하는 경우 lombok.config 파일에 <code>lombok.anyConstructor.addConstructorProperties=true</code>를 추가할 수 있습니다.)</li>
</ul>
<h2 id="3-FieldReflectionArbitraryIntrospector"><a href="#3-FieldReflectionArbitraryIntrospector" class="headerlink" title="3. FieldReflectionArbitraryIntrospector"></a>3. <strong>FieldReflectionArbitraryIntrospector</strong></h2><ul>
<li>리플렉션을 사용하여 새 인스턴스를 생성하고 필드를 설정하므로, 생성할 클래스는 인자가 없는 생성자(또는 기본 생성자)와 getter 또는 setter 중 하나를 가져야 합니다.</li>
<li>만약 final이 아닌 변수가 선언되어 있다면 getter 또는 setter 없이도 사용 가능합니다.</li>
</ul>
<h2 id="4-BuilderArbitraryIntrospector"><a href="#4-BuilderArbitraryIntrospector" class="headerlink" title="4. BuilderArbitraryIntrospector"></a>4. BuilderArbitraryIntrospector</h2><ul>
<li>클래스 빌더를 사용하여 클래스를 생성합니다.</li>
</ul>
<h2 id="5-FailoverArbitraryIntrospector"><a href="#5-FailoverArbitraryIntrospector" class="headerlink" title="5. FailoverArbitraryIntrospector"></a>5. FailoverArbitraryIntrospector</h2><ul>
<li>테스트 대상이 너무 다양한 객체를 내부적으로 가지고 있을 때 여러 <code>Introspector</code>를 제공할 수 있습니다.</li>
<li><code>FailoverArbitraryIntrospector</code>를 사용하면 두 개 이상의 introspector를 사용할 수 있으며, introspector 중 하나가 생성에 실패하더라도 <code>FailoverArbitraryIntrospector</code>는 계속 다음 introspector로 객체 생성을 시도합니다.</li>
</ul>
<h2 id="6-PriorityConstructorArbitraryIntrospector"><a href="#6-PriorityConstructorArbitraryIntrospector" class="headerlink" title="6. PriorityConstructorArbitraryIntrospector"></a>6. <strong>PriorityConstructorArbitraryIntrospector</strong></h2><ul>
<li>생성자를 사용해서 타입을 생성합니다.</li>
<li>다만, 생성자 파라미터 이름을 인식하지 못하면 ArbitraryBuilder API를 사용해 생성자 파라미터를 제어할 수 없습니다.</li>
<li>일반적으로 컴파일 시 바이트 코드에 생성자명과 파라미터명이 코드에서 작상한대로 저장되지 않으므로(arg1, arg2 이런식으로 저장됨) 생성자와 파라미터명을 런타임에 알 수 있도록 매핑 시킬 수 있어야 합니다.</li>
<li>Fixture monkey 공식문서에선 아래 3가지 방법을 제시하고 있습니다.<ul>
<li>record 타입</li>
<li>JVM 옵션 -parameters 활성화</li>
<li>생성자에 @ConstructorProperties 존재</li>
</ul>
</li>
</ul>
<details>
<summary>ConstructorPropertiesArbitraryIntrospector와의 차이점</summary>


</details>

<h2 id="7-요약"><a href="#7-요약" class="headerlink" title="7. 요약"></a><strong>7. 요약</strong></h2><table>
<thead>
<tr>
<th>Introspector</th>
<th>설명</th>
<th>특징</th>
</tr>
</thead>
<tbody><tr>
<td>BeanArbitraryIntrospector</td>
<td>기본 introspector로, 인자가 없는 생성자와 setter를 이용해 객체 생성</td>
<td>일반적인 객체 생성에 적합</td>
</tr>
<tr>
<td>ConstructorPropertiesArbitraryIntrospector</td>
<td>@ConstructorProperties 또는 레코드 타입을 통해 생성자 사용 가능</td>
<td>생성자 프로퍼티를 통한 특정 생성 가능</td>
</tr>
<tr>
<td>FieldReflectionArbitraryIntrospector</td>
<td>필드 리플렉션으로 객체 생성</td>
<td>final이 아닌 필드에 대해 setter 없이도 가능</td>
</tr>
<tr>
<td>BuilderArbitraryIntrospector</td>
<td>빌더 패턴을 사용하여 객체 생성</td>
<td>빌더 패턴이 있는 객체에 적합</td>
</tr>
<tr>
<td>FailoverArbitraryIntrospector</td>
<td>여러 introspector 중 사용 가능한 방식으로 객체 생성 시도</td>
<td>다양한 객체 생성 조건에 유연하게 대응</td>
</tr>
<tr>
<td>PriorityConstructorArbitraryIntrospector</td>
<td>우선 순위가 높은 생성자를 사용하여 객체 생성</td>
<td>생성자 우선 사용 상황에 적합</td>
</tr>
</tbody></table>
<hr>
<h1 id="4-사용-예시"><a href="#4-사용-예시" class="headerlink" title="4. 사용 예시"></a>4. 사용 예시</h1><h2 id="1-PriorityConstructorArbitraryIntrospector-사용"><a href="#1-PriorityConstructorArbitraryIntrospector-사용" class="headerlink" title="1. PriorityConstructorArbitraryIntrospector 사용"></a><strong>1. PriorityConstructorArbitraryIntrospector 사용</strong></h2><ul>
<li>PriorityConstructorArbitraryIntrospector를 이용해 기 존재하는 생성자를 활용하여 객체를 생성합니다.</li>
<li>Repository에서 데이터를 조회할 경우 <code>@QueryProjection</code> 을 활용하기 위해 DTO(혹은 VO)에서 생성자를 만들어서 사용하고 있는데, 이런 케이스처럼 final 필드가 다수 존재하여, 테스트 객체 생성에 비효율이 발생할 경우 사용하기 좋습니다.</li>
<li>해당 예시에선 withParameterNamesResolver() 메서드를 이용하여 생성자의 파라미터명을 명시적으로 작성하였습니다. 혹은 위에 설명한 다른 방법을 이용해 <strong>런타임</strong>에 파라미터명을 알 수 있도록 합니다.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> FixtureMonkey fixtureMonkey;</span><br><span class="line"></span><br><span class="line"><span class="meta">@BeforeEach</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.fixtureMonkey = FixtureMonkey.builder()</span><br><span class="line">            .objectIntrospector(PriorityConstructorArbitraryIntrospector.INSTANCE</span><br><span class="line">                    .withParameterNamesResolver(constructor -&gt; List.of(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;email&quot;</span>, <span class="string">&quot;phoneNumber&quot;</span>, <span class="string">&quot;age&quot;</span>, <span class="string">&quot;verified&quot;</span>, <span class="string">&quot;createdAt&quot;</span>)))</span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ParameterizedTest(name = &quot;&#123;index&#125; =&gt; age=&#123;0&#125;, expectedCategory=&#123;1&#125;&quot;)</span></span><br><span class="line"><span class="meta">@MethodSource(&quot;getPersonVoArguments&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testPersonVoMethods</span><span class="params">(Integer age, String expectedCategory)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// given</span></span><br><span class="line">    PersonVo personVo = fixtureMonkey.giveMeBuilder(PersonVo.class)</span><br><span class="line">            .set(javaGetter(PersonVo::getId), <span class="number">1L</span>)</span><br><span class="line">            .set(<span class="string">&quot;age&quot;</span>, age)</span><br><span class="line">            .sample();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// when</span></span><br><span class="line">    String ageCategory = personVo.getAgeCategory();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// then</span></span><br><span class="line">    assertThat(ageCategory).isEqualTo(expectedCategory);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Stream&lt;Arguments&gt; <span class="title">getPersonVoArguments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Stream.of(</span><br><span class="line">            Arguments.of(<span class="keyword">null</span>, <span class="string">&quot;Unknown&quot;</span>),</span><br><span class="line">            Arguments.of(<span class="number">15</span>, <span class="string">&quot;청소년&quot;</span>),</span><br><span class="line">            Arguments.of(<span class="number">30</span>, <span class="string">&quot;청년&quot;</span>),</span><br><span class="line">            Arguments.of(<span class="number">70</span>, <span class="string">&quot;시니어&quot;</span>)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="실행-결과"><a href="#실행-결과" class="headerlink" title="실행 결과"></a>실행 결과</h3>

<ul>
<li>테스트에 필요한 <code>age</code>만 넣고 실행 시, 나머지 final 필드들은 알아서 fixture monkey에 의해 채워지거나 null 허용필드인 경우 null이 입력된 것을 볼 수 있습니다.</li>
</ul>
<h2 id="2-FieldReflectionArbitraryIntrospector-사용"><a href="#2-FieldReflectionArbitraryIntrospector-사용" class="headerlink" title="2. FieldReflectionArbitraryIntrospector 사용"></a>2. <strong>FieldReflectionArbitraryIntrospector 사용</strong></h2><ul>
<li>생성자의 파라미터에 존재하지 않는 값 ( id )을 수정하기 위해 <code>FieldReflectionArbitraryIntrospector</code> 를 활용하여 객체를 생성합니다.</li>
<li>Entity class인 경우 보통 생성자에 id 필드를 포함한 생성자가 존재하지 않기 때문에(JPA ID를 생성, 관리 하도록 일임하기 때문) Entity 객체 생성 시 사용하기 좋습니다.</li>
</ul>
<br>

<h3 id="Member-Entity"><a href="#Member-Entity" class="headerlink" title="Member Entity"></a>Member Entity</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@NoArgsConstructor(access = AccessLevel.PROTECTED)</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;member&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> String phoneNumber;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isVerified;</span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createdAt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MemberEntity</span><span class="params">(String name, String email, String phoneNumber, <span class="keyword">int</span> age, <span class="keyword">boolean</span> isVerified)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">        <span class="keyword">this</span>.phoneNumber = phoneNumber;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.isVerified = isVerified;</span><br><span class="line">        <span class="keyword">this</span>.createdAt = LocalDateTime.now();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verify</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isVerified = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="비즈니스-로직"><a href="#비즈니스-로직" class="headerlink" title="비즈니스 로직"></a>비즈니스 로직</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 특정 ID를 가진 회원을 활성화</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> memberId 회원 ID</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 활성화된 회원</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Member <span class="title">activateMember</span><span class="params">(<span class="keyword">long</span> memberId)</span> </span>&#123;</span><br><span class="line">    MemberEntity entity = memberRepository.findById(memberId)</span><br><span class="line">            .orElseThrow(() -&gt; <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;존재하지 않는 회원 ID: &quot;</span> + memberId));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (entity.isVerified()) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">&quot;이미 활성화된 회원입니다: &quot;</span> + memberId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    entity.verify();</span><br><span class="line">    entity = memberRepository.save(entity);</span><br><span class="line">    <span class="keyword">return</span> Member.of(entity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>

<h3 id="테스트코드-with-fixture-monkey"><a href="#테스트코드-with-fixture-monkey" class="headerlink" title="테스트코드 with. fixture monkey"></a>테스트코드 with. fixture monkey</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> FixtureMonkey fixtureMonkey;</span><br><span class="line"><span class="keyword">private</span> MemberService memberService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@BeforeEach</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    fixtureMonkey = FixtureMonkey.builder()</span><br><span class="line">            .objectIntrospector(FieldReflectionArbitraryIntrospector.INSTANCE)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    memberService = <span class="keyword">new</span> MemberService(<span class="keyword">new</span> FakeMemberRepository());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RepeatedTest(value = 100)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testActivateMemberUsingFixtureMonkey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// given</span></span><br><span class="line">    MemberEntity entity = fixtureMonkey.giveMeBuilder(MemberEntity.class)</span><br><span class="line">            .set(<span class="string">&quot;isVerified&quot;</span>, <span class="keyword">false</span>)</span><br><span class="line">            .sample();</span><br><span class="line"></span><br><span class="line">    Member savedMember = memberService.save(entity);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// when</span></span><br><span class="line">    Member activatedMember = memberService.activateMember(savedMember.getId());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// then</span></span><br><span class="line">    assertThat(activatedMember.isVerified()).isTrue();</span><br><span class="line">    assertThat(entity.getId()).isEqualTo(activatedMember.getId());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<ul>
<li>fixture monkey를 이용해 MemberEntity 객체 생성 시, 테스트해야하는 비즈니스 로직에서 필요한 값만 지정하여 객체를 생성합니다.<ul>
<li>예제에선 isVerified의 상태를 true로 변경하는 것</li>
</ul>
</li>
<li>이로 인해 테스트코드의 본래 목적인, 비즈니스 로직 검증에만 집중할 수 있는 간단한 테스트코드를 작성 할 수 있습니다.</li>
</ul>
<hr>
<h1 id="5-퀴즈"><a href="#5-퀴즈" class="headerlink" title="5. 퀴즈"></a>5. 퀴즈</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EventEligibilityChecker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MemberService memberService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;event.vip.member.ids&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String vipMemberIds;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ZoneOffset KST = ZoneOffset.of(<span class="string">&quot;+09:00&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 특정 이벤트 참여 가능 여부를 확인</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 조건:</span></span><br><span class="line"><span class="comment">     * - VIP 회원이거나</span></span><br><span class="line"><span class="comment">     * - 관리자 권한을 가진 회원이거나</span></span><br><span class="line"><span class="comment">     * - 이벤트 기간 외에 요청한 회원이라면 false</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 그렇지 않다면 true를 반환한다.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> memberId 확인할 회원 ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> eventStartTime 이벤트 시작 시간</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> eventEndTime 이벤트 종료 시간</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 참여 가능 여부</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canParticipate</span><span class="params">(<span class="keyword">long</span> memberId, LocalDateTime eventStartTime, LocalDateTime eventEndTime)</span> </span>&#123;</span><br><span class="line">        OffsetDateTime currentTime = OffsetDateTime.now();</span><br><span class="line">        <span class="keyword">boolean</span> isEligible = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> isVipMember = checkVipMember(memberId);</span><br><span class="line">        <span class="keyword">boolean</span> isAdminMember =</span><br><span class="line">                checkAdminMember(memberId);</span><br><span class="line">        <span class="keyword">boolean</span> isOutsideEventPeriod = checkOutsideEventPeriod(currentTime, eventStartTime, eventEndTime);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isVipMember || isAdminMember || isOutsideEventPeriod) &#123;</span><br><span class="line">            isEligible = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> isEligible;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkVipMember</span><span class="params">(<span class="keyword">long</span> memberId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(vipMemberIds.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">                .map(String::trim)</span><br><span class="line">                .map(Integer::parseInt)</span><br><span class="line">                .anyMatch(id -&gt; id == memberId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkAdminMember</span><span class="params">(<span class="keyword">long</span> memberId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memberService.hasAdminRole(memberId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkOutsideEventPeriod</span><span class="params">(OffsetDateTime currentTime, LocalDateTime eventStartTime, LocalDateTime eventEndTime)</span> </span>&#123;</span><br><span class="line">        OffsetDateTime eventStart = eventStartTime.atOffset(KST);</span><br><span class="line">        OffsetDateTime eventEnd = eventEndTime.atOffset(KST);</span><br><span class="line">        <span class="keyword">return</span> currentTime.isBefore(eventStart) || currentTime.isAfter(eventEnd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>

<p>위 같은 코드는 어떻게 테스트 코드를 작성 할 수 있을까요?</p>
<h2 id="1-테스트코드-작성"><a href="#1-테스트코드-작성" class="headerlink" title="1. 테스트코드 작성"></a>1. 테스트코드 작성</h2><h3 id="1-Fixture-Monkey-사용"><a href="#1-Fixture-Monkey-사용" class="headerlink" title="1. Fixture Monkey 사용"></a>1. Fixture Monkey 사용</h3><details>
<summary>예시 코드</summary>

<ul>
<li>해당 케이스에서 적용 할 수 있는 <code>Introspector</code> 가 존재하지 않기 때문에 Fixture monkey로 객체를 생성 할 수 없습니다.<ul>
<li>혹 제가 잘못 알고 있다면, 댓글 등으로 조언 부탁드립니다. (__)</li></ul></li></ul></details>





<br>

<h3 id="2-SpringBootTest와-TestPropertySource-사용"><a href="#2-SpringBootTest와-TestPropertySource-사용" class="headerlink" title="2. @SpringBootTest와 @TestPropertySource 사용"></a>2. @SpringBootTest와 @TestPropertySource 사용</h3><details>
<summary>예시 코드</summary>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@TestPropertySource(properties = &#123;</span></span><br><span class="line"><span class="meta">        &quot;event.vip.member.ids=1,2,3&quot;</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventEligibilityCheckerTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EventEligibilityChecker eventEligibilityChecker;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MemberService memberService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ParameterizedTest(name = &quot;&#123;index&#125; =&gt; memberId=&#123;0&#125;, startTime=&#123;1&#125;, endTime=&#123;2&#125;, expectedResult=&#123;3&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@MethodSource(&quot;getMemberArguments&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testCanParticipate</span><span class="params">(<span class="keyword">int</span> memberId, LocalDateTime startTime, LocalDateTime endTime, <span class="keyword">boolean</span> expectedResult)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// when</span></span><br><span class="line">        <span class="keyword">boolean</span> result = eventEligibilityChecker.canParticipate(memberId, startTime, endTime);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// then</span></span><br><span class="line">        assertThat(result).isEqualTo(expectedResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Stream&lt;Object[]&gt; getMemberArguments() &#123;</span><br><span class="line">        <span class="keyword">return</span> Stream.of(</span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">1</span>, LocalDateTime.now().minusDays(<span class="number">1</span>), LocalDateTime.now().plusDays(<span class="number">1</span>), <span class="keyword">false</span>&#125;, <span class="comment">// VIP 멤버</span></span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">99</span>, LocalDateTime.now().minusDays(<span class="number">1</span>), LocalDateTime.now().plusDays(<span class="number">1</span>), <span class="keyword">false</span>&#125;, <span class="comment">// 관리자 멤버</span></span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">4</span>, LocalDateTime.now().plusDays(<span class="number">1</span>), LocalDateTime.now().plusDays(<span class="number">2</span>), <span class="keyword">false</span>&#125;, <span class="comment">// 이벤트 기간 외</span></span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">101</span>, LocalDateTime.now().minusDays(<span class="number">1</span>), LocalDateTime.now().plusDays(<span class="number">1</span>), <span class="keyword">true</span>&#125; <span class="comment">// 일반 멤버 (참여 가능)</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<br>

<h3 id="3-Reflection-사용"><a href="#3-Reflection-사용" class="headerlink" title="3. Reflection 사용"></a>3. Reflection 사용</h3><details>
<summary>예시 코드</summary>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EventEligibilityCheckerTestWithReflection</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> EventEligibilityChecker eventEligibilityChecker;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        eventEligibilityChecker = <span class="keyword">new</span> EventEligibilityChecker(<span class="keyword">new</span> MemberService(<span class="keyword">new</span> FakeMemberRepository()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ReflectionTestUtils를 사용해 @Value 필드 설정</span></span><br><span class="line">        ReflectionTestUtils.setField(eventEligibilityChecker, <span class="string">&quot;vipMemberIds&quot;</span>, <span class="string">&quot;1,2,3&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ParameterizedTest(name = &quot;&#123;index&#125; =&gt; memberId=&#123;0&#125;, startTime=&#123;1&#125;, endTime=&#123;2&#125;, expectedResult=&#123;3&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@MethodSource(&quot;getMemberArguments&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testCanParticipate</span><span class="params">(<span class="keyword">int</span> memberId, LocalDateTime startTime, LocalDateTime endTime, <span class="keyword">boolean</span> expectedResult)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// when</span></span><br><span class="line">        <span class="keyword">boolean</span> result = eventEligibilityChecker.canParticipate(memberId, startTime, endTime);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// then</span></span><br><span class="line">        assertThat(result).isEqualTo(expectedResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Stream&lt;Object[]&gt; getMemberArguments() &#123;</span><br><span class="line">        <span class="keyword">return</span> Stream.of(</span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">1</span>, LocalDateTime.now().minusDays(<span class="number">1</span>), LocalDateTime.now().plusDays(<span class="number">1</span>), <span class="keyword">false</span>&#125;, <span class="comment">// VIP 멤버</span></span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">99</span>, LocalDateTime.now().minusDays(<span class="number">1</span>), LocalDateTime.now().plusDays(<span class="number">1</span>), <span class="keyword">false</span>&#125;, <span class="comment">// 관리자 멤버</span></span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">4</span>, LocalDateTime.now().plusDays(<span class="number">1</span>), LocalDateTime.now().plusDays(<span class="number">2</span>), <span class="keyword">false</span>&#125;, <span class="comment">// 이벤트 기간 외</span></span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">101</span>, LocalDateTime.now().minusDays(<span class="number">1</span>), LocalDateTime.now().plusDays(<span class="number">1</span>), <span class="keyword">true</span>&#125; <span class="comment">// 일반 멤버 (참여 가능)</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</details>

<hr>
<h1 id="6-테스트-하기-쉬운-코드"><a href="#6-테스트-하기-쉬운-코드" class="headerlink" title="6. 테스트 하기 쉬운 코드"></a>6. 테스트 하기 쉬운 코드</h1><blockquote>
<p>No Silver Bullet. - Fred Brooks</p>
</blockquote>
<p>단지 테스트코드 작성을 도와주는 도구일 뿐 Fixture Monkey 도 만능은 아닙니다.</p>
<p>테스트코드를 작성하기 어렵다는 건 테스트 하고자 하는 코드 (<a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/System_under_test">System under test</a>)의 설계 혹은 구조가 잘못되어 있다고 테스트코드가 신호를 보내고 있다고 생각해야합니다.</p>
<h2 id="1-테스트가-어려운-이유"><a href="#1-테스트가-어려운-이유" class="headerlink" title="1. 테스트가 어려운 이유"></a>1. 테스트가 어려운 이유</h2><h3 id="a-불확실성"><a href="#a-불확실성" class="headerlink" title="a. 불확실성"></a>a. 불확실성</h3><ul>
<li>불확실성이란 코드가 외부 데이터나 상태에 의존하여 매번 다른 결과를 만들어내는 것을 의미합니다.</li>
<li>예를 들어, 현재 시간을 기준으로 동작하는 코드, 랜덤 값을 생성하는 코드, 전역 변수를 사용하는 코드 등은 매 실행 시마다 결과가 달라질 수 있습니다.</li>
<li>문제코드에선 <code>@Value</code>로 properties에서 주입받는 값들과 <code>OffsetDateTime.now()</code>를 불확실성이라고 할 수 있습니다.</li>
</ul>
<h3 id="b-부수효과"><a href="#b-부수효과" class="headerlink" title="b. 부수효과"></a>b. 부수효과</h3><ul>
<li>부수효과라 함은 함수 외부의 상태를 변경하는 것을 의미합니다.</li>
<li>예를 들어 메일을 전송하거나 파일에 데이터를 기록하거나 데이터베이스에 저장하는 코드는 외부 시스템에 변화를 일으킵니다.</li>
<li>이런 코드들은 단순히 리턴 값을 확인하는 것만으로는 테스트가 불가능하고, 실제로 외부 상태가 바뀌었는지 확인해야 하기 때문에 테스트 비용이 증가하게 됩니다.</li>
</ul>
<h2 id="2-테스트-하기-쉬운-코드로-수정하기"><a href="#2-테스트-하기-쉬운-코드로-수정하기" class="headerlink" title="2. 테스트 하기 쉬운 코드로 수정하기"></a>2. 테스트 하기 쉬운 코드로 수정하기</h2><details>
<summary>수정된 프로덕션 코드 ( SUT )</summary>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EventEligibilityCheckerV2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MemberService memberService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> VIPProperties vipProperties;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ClockProvider clockProvider;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ZoneOffset KST = ZoneOffset.of(<span class="string">&quot;+09:00&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 특정 이벤트 참여 가능 여부를 확인</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 조건:</span></span><br><span class="line"><span class="comment">     * - VIP 회원이거나</span></span><br><span class="line"><span class="comment">     * - 관리자 권한을 가진 회원이거나</span></span><br><span class="line"><span class="comment">     * - 이벤트 기간 외에 요청한 회원이라면 false</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 그렇지 않다면 true를 반환한다.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> memberId 확인할 회원 ID</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> eventStartTime 이벤트 시작 시간</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> eventEndTime 이벤트 종료 시간</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 참여 가능 여부</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canParticipate</span><span class="params">(<span class="keyword">long</span> memberId, LocalDateTime eventStartTime, LocalDateTime eventEndTime)</span> </span>&#123;</span><br><span class="line">        OffsetDateTime currentTime = clockProvider.now();</span><br><span class="line">        <span class="keyword">boolean</span> isEligible = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> isVipMember = checkVipMember(memberId);</span><br><span class="line">        <span class="keyword">boolean</span> isAdminMember =</span><br><span class="line">                checkAdminMember(memberId);</span><br><span class="line">        <span class="keyword">boolean</span> isOutsideEventPeriod = checkOutsideEventPeriod(currentTime, eventStartTime, eventEndTime);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isVipMember || isAdminMember || isOutsideEventPeriod) &#123;</span><br><span class="line">            isEligible = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> isEligible;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkVipMember</span><span class="params">(<span class="keyword">long</span> memberId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vipProperties.getIds().contains(memberId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkAdminMember</span><span class="params">(<span class="keyword">long</span> memberId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memberService.hasAdminRole(memberId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkOutsideEventPeriod</span><span class="params">(OffsetDateTime currentTime, LocalDateTime eventStartTime, LocalDateTime eventEndTime)</span> </span>&#123;</span><br><span class="line">        OffsetDateTime eventStart = eventStartTime.atOffset(KST);</span><br><span class="line">        OffsetDateTime eventEnd = eventEndTime.atOffset(KST);</span><br><span class="line">        <span class="keyword">return</span> currentTime.isBefore(eventStart) || currentTime.isAfter(eventEnd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">VIPProperties</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Long&gt; <span class="title">getIds</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;event.vip.member&quot;)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VIPPropertiesImpl</span> <span class="keyword">implements</span> <span class="title">VIPProperties</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String ids;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ConstructorBinding</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VIPPropertiesImpl</span><span class="params">(String ids)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ids = ids;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Long&gt; <span class="title">getIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(<span class="keyword">this</span>.ids.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">                .map(String::trim)</span><br><span class="line">                .map(Long::parseLong)</span><br><span class="line">                .toList();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</details>

<br>
<details>
<summary>수정된 테스트 코드</summary>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventEligibilityCheckerV2Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> EventEligibilityCheckerV2 eventEligibilityChecker;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> year = <span class="number">2024</span>;</span><br><span class="line">        <span class="keyword">int</span> month = <span class="number">12</span>;</span><br><span class="line">        <span class="keyword">int</span> day =<span class="number">13</span>;</span><br><span class="line">        <span class="keyword">int</span> hour = <span class="number">11</span>;</span><br><span class="line">        <span class="keyword">int</span> minute = <span class="number">11</span>;</span><br><span class="line">        <span class="keyword">int</span> second = <span class="number">11</span>;</span><br><span class="line"></span><br><span class="line">        eventEligibilityChecker = <span class="keyword">new</span> EventEligibilityCheckerV2(</span><br><span class="line">                <span class="keyword">new</span> MemberService(<span class="keyword">new</span> FakeMemberRepository())</span><br><span class="line">                , <span class="keyword">new</span> FakeVIPProperties(Arrays.asList(<span class="number">1L</span>,<span class="number">2L</span>,<span class="number">3L</span>))</span><br><span class="line">                , <span class="keyword">new</span> FakeSystemClockProvider(OffsetDateTime.of(year, month, day, hour, minute, second, <span class="number">11</span>, ZoneOffset.UTC))</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ParameterizedTest(name = &quot;&#123;index&#125; =&gt; memberId=&#123;0&#125;, startTime=&#123;1&#125;, endTime=&#123;2&#125;, expectedResult=&#123;3&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@MethodSource(&quot;getMemberArguments&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testCanParticipate</span><span class="params">(<span class="keyword">int</span> memberId, LocalDateTime startTime, LocalDateTime endTime, <span class="keyword">boolean</span> expectedResult)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// when</span></span><br><span class="line">        <span class="keyword">boolean</span> result = eventEligibilityChecker.canParticipate(memberId, startTime, endTime);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// then</span></span><br><span class="line">        assertThat(result).isEqualTo(expectedResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Stream&lt;Object[]&gt; getMemberArguments() &#123;</span><br><span class="line">        <span class="keyword">int</span> year = <span class="number">2024</span>;</span><br><span class="line">        <span class="keyword">int</span> month = <span class="number">12</span>;</span><br><span class="line">        <span class="keyword">int</span> day =<span class="number">13</span>;</span><br><span class="line">        <span class="keyword">int</span> hour = <span class="number">11</span>;</span><br><span class="line">        <span class="keyword">int</span> minute = <span class="number">11</span>;</span><br><span class="line">        <span class="keyword">int</span> second = <span class="number">11</span>;</span><br><span class="line"></span><br><span class="line">        LocalDateTime eventStartDate = LocalDateTime.of(year, month, day-<span class="number">1</span>, hour, minute, second);</span><br><span class="line">        LocalDateTime eventEndDate = LocalDateTime.of(year, month, day+<span class="number">1</span>, hour, minute, second);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Stream.of(</span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">1</span>, eventStartDate, eventEndDate, <span class="keyword">false</span>&#125;, <span class="comment">// VIP 멤버</span></span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">99</span>, eventStartDate, eventEndDate, <span class="keyword">false</span>&#125;, <span class="comment">// 관리자 멤버</span></span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">4</span>, eventEndDate.plusDays(<span class="number">1</span>), eventEndDate.plusDays(<span class="number">2</span>), <span class="keyword">false</span>&#125;, <span class="comment">// 이벤트 기간 외</span></span><br><span class="line">                <span class="keyword">new</span> Object[]&#123;<span class="number">101</span>, eventStartDate, eventEndDate, <span class="keyword">true</span>&#125; <span class="comment">// 일반 멤버 (참여 가능)</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</details>

<br>

<h2 id="3-코드-개선으로-인해-얻게된-이점"><a href="#3-코드-개선으로-인해-얻게된-이점" class="headerlink" title="3. 코드 개선으로 인해 얻게된 이점"></a>3. 코드 개선으로 인해 얻게된 이점</h2><ol>
<li><strong>책임 분리</strong>: 설정값을 전용 프로퍼티 클래스 (VIPProperties)로 관리하게 되어 EventEligibilityCheckerV2의 책임이 명확해졌습니다.</li>
<li><strong>유연성 증가</strong>: VIPProperties, ClockProvider와 같은 인터페이스를 사용하여 설정값에 대한 종속성이 외부로 분리하였고, 설정값을 추상화하여, 다양한 설정 구현체를 주입할 수 있습니다. 위 예시에선 테스트코드 내에서 Fake 구현체 작성하고 해당 구현체로 객체를 생성 하도록하여 테스트하였습니다.</li>
<li><strong>코드 가독성</strong>: @Value 어노테이션 없이 구성 클래스를 사용하므로, 전체적인 코드의 가독성이 향상됩니다.</li>
</ol>
<hr>
<h1 id="7-결론"><a href="#7-결론" class="headerlink" title="7. 결론"></a>7. 결론</h1><p>앞서 설명한 설계와 테스트 코드 개선에 더해 Fixture Monkey와 같은 도구를 활용하면 다음과 같은 이점을 얻을 수 있습니다.</p>
<ol>
<li><p><strong>테스트 데이터 자동 생성</strong></p>
<ul>
<li>Fixture Monkey는 복잡한 객체 구조에 대해 필요한 데이터를 자동으로 생성합니다. 이를 통해 테스트를 작성할 때 불필요한 데이터 생성 로직을 줄이고 테스트 로직에 집중할 수 있습니다.</li>
</ul>
</li>
<li><p><strong>객체의 불변성과 유연성 유지</strong></p>
<ul>
<li>기존 객체를 수정하거나 Setter를 추가하지 않아도 Fixture Monkey를 통해 객체를 유연하게 생성 및 수정할 수 있습니다. 특히, 불변 객체(immutable object)나 생성자가 많은 객체를 쉽게 테스트할 수 있습니다.</li>
</ul>
</li>
<li><p><strong>데이터 커스터마이징</strong></p>
<ul>
<li>특정 필드에 대한 값을 명시적으로 설정하거나 조건에 맞는 객체를 생성할 수 있습니다. 예를 들어, VIP 멤버 ID 목록처럼 특정 조건을 가진 데이터를 간단하게 생성할 수 있습니다.</li>
</ul>
</li>
<li><p><strong>테스트 유지보수 비용 절감</strong></p>
<ul>
<li>새로운 필드가 추가되거나 객체 구조가 변경되어도 Fixture Monkey를 사용하면 테스트 코드 수정 범위를 최소화할 수 있습니다.</li>
</ul>
</li>
</ol>
<br>

<hr>
<p>잘 작성된 테스트는 단순히 코드의 동작을 검증하는 역할을 넘어, 코드의 설계와 구조적 결함을 발견하게 해줍니다.<br><strong>Fixture Monkey</strong>와 같은 도구를 활용하면 코드의 불확실성과 부수효과를 줄이면서도 객체 생성과 테스트를 효율적으로 수행할 수 있습니다.<br>특히, 복잡한 객체나 다양한 조건의 테스트 데이터를 쉽게 생성할 수 있어 <strong>테스트 작성 비용을 절감</strong>하고 <strong>테스트 품질을 향상</strong>시킬 수 있습니다.  </p>
<p>그러나 <strong>도구의 활용보다 중요한 것은 테스트 가능한 설계를 만드는 것</strong>입니다.<br>테스트 가능한 설계는 테스트 코드로 하여금 코드 설계의 개선 방향을 제시하게 하며, 결과적으로 유지보수성과 확장성을 높이는 기반이 됩니다.</p>
<p>긴 글 읽어주셔서 감사합니다.</p>
<hr>
<h1 id="참고자료"><a href="#참고자료" class="headerlink" title="참고자료"></a>참고자료</h1><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://naver.github.io/fixture-monkey/v1-0-0/">Fixture Monkey 공식문서</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://tv.naver.com/v/23650158">테스트 객체는 엣지 케이스까지 찾아주는 Fixture Monkey에게 맡기세요</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://jwchung.github.io/testable-code">Testable Code by Jin-Wook Chung</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://youtu.be/YdtknE_yPk4?si=d8KPekxKZrsj_Rpk">무엇을 테스트할 것인가? 어떻게 테스트할 것인가? (권용근)</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.youtube.com/watch?v=XSkz0kO7J3w">실무에서 적용하는 테스트 코드 작성 방법과 노하우 (김남윤)</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.youtube.com/watch?v=pCE7ibRCZEI">왜 나는 테스트를 작성하기 싫을까? (조성아)</a></li>
</ul>
<hr>
<h3 id="전체-코드"><a href="#전체-코드" class="headerlink" title="전체 코드"></a>전체 코드</h3><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jungguji/fixture-monkey-sample">https://github.com/jungguji/fixture-monkey-sample</a></li>
</ul>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">태그</span><br>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/test/" rel="tag">test</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2024/12/24/%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88%EC%99%80-Redis-Redisson-%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%95%B4%EA%B2%B0%EB%B0%A9%EB%B2%95/" data-tooltip="동시성 이슈와 Redis( Redisson )를 이용한 해결방법" aria-label="이전: 동시성 이슈와 Redis( Redisson )를 이용한 해결방법">
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2023/01/04/1829-Maximum-XOR-for-Each-Query/" data-tooltip="LeetCode 1829. Maximum XOR for Each Query" aria-label="다음: LeetCode 1829. Maximum XOR for Each Query">
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="이 포스트 공유하기">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/" title="Facebook에 공유하기" aria-label="Facebook에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://twitter.com/intent/tweet?text=https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/" title="Twitter에 공유하기" aria-label="Twitter에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://plus.google.com/share?url=https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/" title="Google+에 공유하기" aria-label="Google+에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <script src="https://utteranc.es/client.js" repo="jungguji/blog-comment" issue-term="og:title" theme="github-light" crossorigin="anonymous" async>
</script>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Junggu Ji. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2024/12/24/%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%9D%B4%EC%8A%88%EC%99%80-Redis-Redisson-%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%95%B4%EA%B2%B0%EB%B0%A9%EB%B2%95/" data-tooltip="동시성 이슈와 Redis( Redisson )를 이용한 해결방법" aria-label="이전: 동시성 이슈와 Redis( Redisson )를 이용한 해결방법">
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2023/01/04/1829-Maximum-XOR-for-Each-Query/" data-tooltip="LeetCode 1829. Maximum XOR for Each Query" aria-label="다음: LeetCode 1829. Maximum XOR for Each Query">
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="이 포스트 공유하기">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/" title="Facebook에 공유하기" aria-label="Facebook에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://twitter.com/intent/tweet?text=https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/" title="Twitter에 공유하기" aria-label="Twitter에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="_blank" href="https://plus.google.com/share?url=https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/" title="Google+에 공유하기" aria-label="Google+에 공유하기" rel="external nofollow noopener noreferrer">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/" aria-label="Facebook에 공유하기" rel="external nofollow noopener noreferrer">
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Facebook에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="_blank" href="https://twitter.com/intent/tweet?text=https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/" aria-label="Twitter에 공유하기" rel="external nofollow noopener noreferrer">
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitter에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="_blank" href="https://plus.google.com/share?url=https://jungguji.github.io/2024/11/19/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EC%9D%84-%EB%8D%94-%EC%89%BD%EA%B2%8C-with-Fixture-Monkey/" aria-label="Google+에 공유하기" rel="external nofollow noopener noreferrer">
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Google+에 공유하기</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Junggu Ji</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-fvy43rs4ns3qkm3cliupi5qtnm0vwph13v4ev99f0qvrcz9tbdyatctmah0i.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
